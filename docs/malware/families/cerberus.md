# Cerberus

Cerberus was the Android banking trojan whose 2020 source code leak became the single most consequential event in mobile malware history. Sold as Malware-as-a-Service (MaaS) from mid-2019 through mid-2020, it introduced a polished rental model to a market previously dominated by [Anubis](anubis.md). When the operation collapsed and its source hit underground forums, it seeded an entire lineage of successors: [Alien](alien.md), [Ermac](ermac.md), [Hook](hook.md), and dozens of unnamed forks that persist today.

## Overview

| Attribute | Details |
|-----------|---------|
| First Seen | June 2019 |
| Last Seen | August 2020 (original operation) |
| Status | Source leaked September 2020, forks still active |
| Type | Banking trojan (MaaS) |
| Attribution | Russian-speaking developer(s), identity unknown |
| Aliases | Cerberus v1, Cerberus v2 |
| Source | Leaked freely on Russian-speaking underground forum after failed auction |

## Origin and Lineage

Cerberus [appeared in June 2019](https://www.threatfabric.com/blogs/cerberus-a-new-banking-trojan-from-the-underworld) when its author began advertising rental access on underground forums. The developer claimed the trojan had been used in private operations for two years prior and was written entirely from scratch rather than derived from [Anubis](anubis.md), a claim that [ThreatFabric disputed](https://www.threatfabric.com/blogs/cerberus-a-new-banking-trojan-from-the-underworld) based on code structure similarities.

The original MaaS operation ran for roughly one year. By mid-2020, internal disputes fractured the development team. In July 2020, the author [put the entire project up for auction](https://securityaffairs.com/106433/malware/cerberus-android-trojan-auction.html) with a starting price of $50,000 and a buy-it-now price of $100,000. The package included APK source code, the admin panel, C2 server code, installation guides, setup scripts, and the active customer list. The auction failed to attract a buyer.

In September 2020, the author released the full source code for free to premium members of a popular Russian-speaking underground forum. [Kaspersky documented](https://www.kaspersky.com/about/press-releases/the-rise-of-cerberus) an immediate spike in infections across Russia and Europe as low-skill actors began deploying their own builds. This leak directly spawned the next generation: [ThreatFabric identified Alien](https://www.threatfabric.com/blogs/alien_the_story_of_cerberus_demise) as the first notable fork even before the public leak, followed by [Ermac](ermac.md) in 2021 and [Hook](hook.md) in 2023.

## Distribution

Cerberus reached devices through multiple channels:

| Vector | Details |
|--------|---------|
| Smishing | SMS messages with links to fake banking or utility pages that served the APK |
| Phishing sites | Typosquatted domains mimicking legitimate app download pages |
| Google Play droppers | In July 2020, [Avast discovered a Cerberus dropper](https://blog.avast.com/avast-finds-banking-trojan-cerberus-on-google-play-avast) disguised as a Spanish currency converter ("Calculadora de Moneda") with over 10,000 downloads. The app behaved legitimately for several weeks before activating dropper code to fetch the banking payload. |
| Third-party app stores | APKs distributed through unofficial Android markets |

The dropper-on-Play technique was notable: the app passed Google Play Protect checks for weeks as a genuine currency converter, then received a C2 command that activated the dropper component to silently download and install the Cerberus banking payload.

## Capabilities

Cerberus evolved significantly between its initial release and the v2 update in early 2020.

### Version 1 (June 2019)

| Capability | Implementation |
|------------|----------------|
| [Overlay attacks](../../attacks/overlay-attacks.md) | WebView-based injects triggered via [accessibility service](../../permissions/special/bind-accessibility-service.md) foreground detection |
| [SMS interception](../../attacks/sms-interception.md) | Read, send, and forward SMS for OTP theft |
| Contact harvesting | Exfiltrate contact list to C2 |
| [Keylogging](../../attacks/keylogging.md) | [Accessibility](../../attacks/accessibility-abuse.md)-based keystroke capture |
| App listing | Enumerate installed packages to determine relevant inject targets |
| Device info collection | IMEI, SIM info, installed apps, device model |
| Self-protection | Hide app icon, prevent uninstallation via [device admin](../../attacks/device-admin-abuse.md) |
| Anti-analysis (pedometer) | Used the device accelerometer as a step counter; payload only activates after a threshold of physical steps is reached, defeating sandbox and emulator analysis |

The pedometer trick was Cerberus's most distinctive evasion technique. Since automated analysis environments and emulators do not generate real accelerometer data, the step counter never increments, and the malware stays dormant.

### Version 2 (January 2020)

[ThreatFabric's "Year of the RAT" report](https://www.threatfabric.com/blogs/2020_year_of_the_rat) documented the v2 upgrade:

| Capability | Implementation |
|------------|----------------|
| RAT (Remote Access Trojan) | TeamViewer-based remote access enabling full device control |
| Google Authenticator theft | Abuses accessibility to read 2FA codes directly from the Authenticator app UI |
| Screen lock credential theft | Captures PIN codes and swipe unlock patterns via accessibility |
| File system traversal | RAT service can browse the device file system and download contents |
| Improved C2 protocol | Refactored communication protocol with updated encryption |

The ability to [steal Google Authenticator 2FA codes](https://www.bleepingcomputer.com/news/security/cerberus-android-malware-can-bypass-2fa-unlock-devices-remotely/) was significant: rather than intercepting SMS-based OTPs, Cerberus read the codes directly from the Authenticator app's UI through accessibility events, bypassing the shift away from SMS-based 2FA.

## Technical Details

### Accessibility Abuse

Cerberus's core functionality depends on the Android [Accessibility Service](../../permissions/special/bind-accessibility-service.md). Once the user grants accessibility privileges, the malware:

1. Auto-grants itself additional permissions (SMS, phone calls) without user interaction
2. Monitors `TYPE_WINDOW_STATE_CHANGED` events to detect when target apps enter the foreground
3. Injects WebView-based [overlay screens](../../attacks/overlay-attacks.md) that mimic the target app's login UI
4. Logs keystrokes across all applications
5. In v2, reads Google Authenticator codes and screen lock patterns

### C2 Communication

The C2 protocol uses HTTP POST requests to communicate with the command-and-control server. Data is encrypted before transmission. The bot registers with the C2 on first launch, sending device fingerprint data, and then polls for commands at regular intervals.

Key C2 commands:

| Command | Action |
|---------|--------|
| `push` | Display push notification to lure user into opening an app |
| `startAuthenticator2` | Launch Google Authenticator and capture displayed codes |
| `startApp` | Open a specified application (triggers overlay) |
| `getContacts` | Exfiltrate contact list |
| `getAccounts` | Steal accounts stored on device |
| `sentSMS` | Send SMS from victim device |
| `startForward` | Forward incoming calls to attacker-specified number |
| `startScreenVNC` | (v2) Initialize RAT session |

### Anti-Analysis

| Technique | Method |
|-----------|--------|
| Pedometer gate | Reads `TYPE_STEP_COUNTER` sensor; payload dormant until step threshold is met |
| Emulator detection | Checks build properties, SIM state, and hardware characteristics |
| Delayed activation | Play Store droppers wait weeks before activating malicious behavior |
| String obfuscation | Critical strings encrypted and resolved at runtime |

### Inject Architecture

Overlay injects are HTML/CSS/JS files hosted on the C2, one per target application. When the malware detects a target app in the foreground via accessibility, it requests the corresponding inject by package name. The WebView renders the inject fullscreen over the legitimate app. Submitted credentials are POSTed back to C2.

## Permissions

| Permission | Purpose |
|------------|---------|
| [BIND_ACCESSIBILITY_SERVICE](../../permissions/special/bind-accessibility-service.md) | Core dependency for overlay triggering, keylogging, auto-granting permissions, and reading Authenticator codes |
| [SYSTEM_ALERT_WINDOW](../../permissions/special/system-alert-window.md) | Display overlay injections over banking apps |
| [READ_SMS](../../permissions/sms/read-sms.md) | Read incoming SMS for OTP interception |
| [RECEIVE_SMS](../../permissions/sms/receive-sms.md) | Intercept SMS in real-time |
| [SEND_SMS](../../permissions/sms/send-sms.md) | Send SMS from the victim device |
| [READ_CONTACTS](../../permissions/contacts/read-contacts.md) | Exfiltrate the contact list |
| [READ_PHONE_STATE](../../permissions/phone/read-phone-state.md) | Collect device identifiers (IMEI, SIM info) |
| [INTERNET](../../permissions/normal/internet.md) | C2 communication |
| [RECEIVE_BOOT_COMPLETED](../../permissions/normal/receive-boot-completed.md) | Persistence across reboots |
| [BIND_DEVICE_ADMIN](../../permissions/special/bind-device-admin.md) | Prevent uninstallation via device admin |

## Target Regions and Financial Institutions

Cerberus primarily targeted European banking customers, with inject kits covering institutions across:

| Region | Countries |
|--------|-----------|
| Western Europe | Spain, France, Italy, Netherlands, UK |
| Eastern Europe | Turkey, Poland |
| North America | United States |
| Asia-Pacific | Australia, India (SBI, ICICI) |

The MaaS model meant targeting depended on individual operators. The core team maintained inject kits for major European banks, while renters could commission custom injects for specific targets. Spanish financial institutions were particularly well-represented, consistent with the [Google Play dropper campaign](https://blog.avast.com/avast-finds-banking-trojan-cerberus-on-google-play-avast) that exclusively targeted Spanish users.

## Notable Campaigns

**June 2019**: Cerberus [first identified by ThreatFabric](https://www.threatfabric.com/blogs/cerberus-a-new-banking-trojan-from-the-underworld) being advertised on underground forums at $2,000/month for private use or $7,000/month with the full feature set.

**January 2020**: The v2 release added RAT capabilities and Google Authenticator theft. [ThreatFabric covered the upgrade](https://www.threatfabric.com/blogs/2020_year_of_the_rat) in their "Year of the RAT" report, noting Cerberus had taken over from [Anubis](anubis.md) as the dominant rented banking malware.

**July 2020**: [Avast discovered a Cerberus dropper](https://blog.avast.com/avast-finds-banking-trojan-cerberus-on-google-play-avast) on Google Play disguised as "Calculadora de Moneda," a Spanish currency converter app with 10,000+ downloads.

**July 2020**: The failed auction. Source code [offered for $50,000-$100,000](https://securityaffairs.com/106433/malware/cerberus-android-trojan-auction.html) after the team dissolved.

**August 2020**: ThreatFabric published ["Alien: the story of Cerberus' demise"](https://www.threatfabric.com/blogs/alien_the_story_of_cerberus_demise), documenting the project's collapse and the emergence of Alien as the first Cerberus fork.

**September 2020**: Full source code [leaked on underground forums](https://securityaffairs.com/108373/cyber-crime/cerberus-source-code-leaked.html). [Kaspersky reported](https://www.kaspersky.com/about/press-releases/the-rise-of-cerberus) an immediate surge in infections across Russia and Europe as new actors began deploying the freely available code.

**October 2020 onward**: The post-leak ecosystem. Cerberus source became the foundation for [Ermac](ermac.md) (2021), [Hook](hook.md) (2023), and numerous unattributed variants that continue to surface. [Cyble tracked](https://cyble.com/blog/hidden-in-plain-sight-errorfathers-deadly-deployment-of-cerberus/) campaigns like "ErrorFather" still deploying Cerberus-derived code as late as 2024, incorporating Domain Generation Algorithms (DGA) and updated obfuscation on top of the original codebase.

## References

- [ThreatFabric - Cerberus: A new banking Trojan from the underworld (June 2019)](https://www.threatfabric.com/blogs/cerberus-a-new-banking-trojan-from-the-underworld)
- [ThreatFabric - 2020: Year of the RAT (January 2020)](https://www.threatfabric.com/blogs/2020_year_of_the_rat)
- [Avast - Cerberus dropper on Google Play (July 2020)](https://blog.avast.com/avast-finds-banking-trojan-cerberus-on-google-play-avast)
- [ThreatFabric - Alien: the story of Cerberus' demise (August 2020)](https://www.threatfabric.com/blogs/alien_the_story_of_cerberus_demise)
- [Security Affairs - Cerberus Android trojan auction (July 2020)](https://securityaffairs.com/106433/malware/cerberus-android-trojan-auction.html)
- [Security Affairs - Cerberus source code leaked (September 2020)](https://securityaffairs.com/108373/cyber-crime/cerberus-source-code-leaked.html)
- [Kaspersky - The rise of Cerberus](https://www.kaspersky.com/about/press-releases/the-rise-of-cerberus)
- [Bleeping Computer - Cerberus can bypass 2FA (February 2020)](https://www.bleepingcomputer.com/news/security/cerberus-android-malware-can-bypass-2fa-unlock-devices-remotely/)
- [Cyble - ErrorFather's deployment of Cerberus (2024)](https://cyble.com/blog/hidden-in-plain-sight-errorfathers-deadly-deployment-of-cerberus/)
