# Ermac

Ermac is the Cerberus fork that proved a leaked source code could be refined into a competitive commercial product. Operated by the threat actor "DukeEugene" and sold as MaaS starting in late 2021, Ermac took the leaked [Cerberus](cerberus.md) codebase, rewrote the encryption layer, updated the obfuscation, and expanded target coverage to over 460 banking and cryptocurrency applications. It served as DukeEugene's primary revenue stream until [Hook](hook.md) replaced it in early 2023.

## Overview

| Attribute | Details |
|-----------|---------|
| First Seen | August 2021 |
| Last Seen | Late 2022 (superseded by Hook) |
| Status | Succeeded by Hook; Ermac 3.0 source leaked August 2025 |
| Type | Banking trojan (MaaS) |
| Attribution | "DukeEugene" (previously linked to BlackRock) |
| Aliases | Ermac 1.0, Ermac 2.0, HookBot (sometimes conflated) |
| Source | Built on leaked Cerberus source; Ermac 3.0 source [leaked in 2025](https://www.bleepingcomputer.com/news/security/ermac-android-malware-source-code-leak-exposes-banking-trojan-infrastructure/) |
| Rental Price | $3,000/month (v1.0), $5,000/month (v2.0) |

## Origin and Lineage

[ThreatFabric identified Ermac](https://www.threatfabric.com/blogs/ermac-another-cerberus-reborn) in September 2021, calling it "another Cerberus reborn." Code analysis confirmed that Ermac is a direct descendant of the leaked Cerberus source: it uses nearly identical data structures for C2 communication and retains the same overall architecture. The modifications focus on encryption, obfuscation, and expanded targeting rather than fundamental redesign.

DukeEugene was already known as the operator behind [BlackRock](https://www.threatfabric.com/blogs/ermac-another-cerberus-reborn), another Android banking trojan discovered in 2020. ThreatFabric noted the cessation of fresh BlackRock samples coinciding with Ermac's emergence, indicating DukeEugene transitioned wholesale from BlackRock to Ermac. The actor advertised Ermac on the same underground forums where Cerberus had previously been sold, positioning it as a superior replacement.

Ermac sits in the middle of the [Cerberus](cerberus.md) lineage: downstream of the original source leak, upstream of [Hook](hook.md). When DukeEugene launched Hook in January 2023, [NCC Group confirmed](https://www.nccgroup.com/research-blog/from-ermac-to-hook-investigating-the-technical-differences-between-two-android-malware-variants/) that Hook was built directly on Ermac's codebase, with all 30 Ermac bot commands present in Hook alongside 38 new additions.

## Distribution

Ermac operators used multiple delivery channels, with a strong preference for phishing sites impersonating legitimate applications.

| Vector | Details |
|--------|---------|
| Fake app websites | Typosquatted domains mimicking legitimate services. [Cyble documented](https://cyble.com/blog/ermac-back-in-action/) a campaign using a fake Bolt Food delivery site targeting Polish users. |
| Phishing pages | Browser-based landing pages distributed via malvertising and social media posts |
| Smishing | SMS messages containing links to the fake app download pages |
| Third-party stores | APKs uploaded to unofficial Android app repositories |
| Malvertising | Paid ads redirecting to phishing domains |

Ermac 2.0 distribution was [particularly active against Polish users](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/), with campaigns impersonating Bolt Food, banking apps, and browser updates. The fake sites were often near-identical to the originals, differing by only a single character in the domain name.

## Capabilities

### Ermac 1.0 (August 2021)

Ermac 1.0 targeted 378 applications and rented for $3,000/month.

| Capability | Implementation |
|------------|----------------|
| [Overlay attacks](../../attacks/overlay-attacks.md) | WebView-based injects triggered by [accessibility service](../../permissions/special/bind-accessibility-service.md) foreground detection |
| SMS interception | Read and redirect incoming SMS for OTP capture |
| Contact harvesting | Exfiltrate device contacts to C2 |
| App listing | Enumerate installed packages to determine overlay targets |
| Account theft | Steal accounts stored on the device via `AccountManager` |
| Push notifications | Display notifications to lure user into opening target apps |
| App cache clearing | Clear app data to force re-authentication, then capture fresh credentials via overlay |
| Open URL | Launch arbitrary URLs in the device browser |

### Ermac 2.0 (May 2022)

[Ermac 2.0 expanded to 467 target applications](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/) and increased the rental price to $5,000/month. [Cyble's analysis](https://cyble.com/blog/ermac-android-malware-increasingly-active/) and [Intel 471's deep dive](https://www.intel471.com/blog/rmac-2-0-perfecting-the-art-of-account-takeover) documented the upgraded version.

| Capability | Implementation |
|------------|----------------|
| Expanded overlays | 467 banking and cryptocurrency app targets (up from 378) |
| Cryptocurrency wallet targeting | Injects for major wallets including MetaMask, Trust Wallet, Coinbase |
| 43 permissions | Self-grants extensive permissions via accessibility on installation |
| Improved obfuscation | Updated string encryption and code obfuscation |
| Broader geo-targeting | Expanded from Eastern European focus to global coverage |

Ermac 2.0 was [the third most active Android banking trojan](https://www.intel471.com/blog/rmac-2-0-perfecting-the-art-of-account-takeover) during Q2 2022.

### Limitations Compared to Successors

Ermac notably lacked several features that would later appear in [Hook](hook.md):

| Missing Feature | Added In |
|----------------|----------|
| VNC/screen streaming | Hook |
| RAT with UI interaction | Hook |
| File manager | Hook |
| ATS (Automated Transfer System) | Hook |
| WhatsApp message extraction | Hook |
| WebSocket communication | Hook |

## Technical Details

### Encryption

The most significant technical departure from Cerberus is the encryption scheme. Where Cerberus used a straightforward encryption approach for C2 communication, [ThreatFabric noted](https://www.threatfabric.com/blogs/ermac-another-cerberus-reborn) that Ermac introduced:

- **String encryption**: Uses the Blowfish algorithm to encrypt hardcoded strings, resolved at runtime
- **C2 communication**: Data encrypted with AES-128-CBC, prepended with a double word containing the length of the encoded data (different from Cerberus's original scheme)

### C2 Protocol

Ermac communicates with its C2 server over HTTP. The protocol follows Cerberus's general pattern but with the updated encryption layer:

1. Bot registers with C2, sending encrypted device fingerprint (IMEI, model, installed apps, SIM info)
2. C2 responds with configuration: target app list, inject URLs, command queue
3. Bot polls C2 at regular intervals for new commands
4. Credential data from overlays is encrypted and POSTed back to C2

Key bot commands:

| Command | Action |
|---------|--------|
| `getSMS` | Retrieve SMS messages from device |
| `sentSMS` | Send SMS from victim device |
| `startApp` | Launch specified application (triggers overlay) |
| `getAccounts` | Steal device accounts |
| `getContacts` | Exfiltrate contact list |
| `getInstalledApps` | Enumerate installed packages |
| `push` | Display push notification |
| `clearCache` | Clear target app data to force re-login |
| `openURL` | Open URL in browser |

### Obfuscation

Ermac applies multiple obfuscation layers on top of the Cerberus base:

| Technique | Details |
|-----------|---------|
| Blowfish string encryption | All sensitive strings encrypted, decrypted at runtime |
| Class/method renaming | Standard [ProGuard](../../packers/r8-proguard.md)-style obfuscation |
| Packed payloads | Some samples use additional packing layers |
| Dynamic C2 resolution | C2 addresses encrypted and resolved at runtime |

### Accessibility Service

Like its Cerberus ancestor, Ermac's entire operation hinges on the Android [Accessibility Service](../../permissions/special/bind-accessibility-service.md). The malware uses a persistent screen urging the user to enable accessibility until they comply. Once enabled, the service:

- Monitors foreground application changes via `TYPE_WINDOW_STATE_CHANGED`
- Auto-grants runtime permissions without user interaction
- Captures keystrokes across all applications
- Triggers overlays when target apps are detected
- Prevents uninstallation by intercepting settings navigation

## Target Regions and Financial Institutions

Ermac's target list grew substantially between versions, with heavy concentration in European and North American banking:

| Region | Notable Targets |
|--------|----------------|
| Poland | Primary initial target; campaigns impersonating Bolt Food, PKO Bank |
| United States | Major banks and financial apps |
| Western Europe | Spain, France, Italy, Germany, UK |
| Eastern Europe | Turkey, Czech Republic |
| Australia | Major banking institutions |
| Cryptocurrency (global) | MetaMask, Trust Wallet, Coinbase, Crypto.com, Binance |

Cryptocurrency wallets became a significant focus in Ermac 2.0. The inject kits included dedicated phishing screens for seed phrase capture across major wallet applications, reflecting the broader trend of Android banking trojans expanding into crypto theft.

## Notable Campaigns

**August 2021**: First Ermac campaigns [identified by ThreatFabric](https://www.threatfabric.com/blogs/ermac-another-cerberus-reborn) targeting Poland with 378 banking app overlays. DukeEugene advertised rentals at $3,000/month.

**May 2022**: Ermac 2.0 launched. [Cyble documented](https://cyble.com/blog/ermac-back-in-action/) campaigns using fake Bolt Food sites to deliver the updated trojan to Polish users. Target list expanded to 467 applications. [Bleeping Computer reported](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/) the expanded targeting and $5,000/month rental price.

**Q2-Q3 2022**: [Intel 471 reported](https://www.intel471.com/blog/rmac-2-0-perfecting-the-art-of-account-takeover) Ermac as the third most active Android banking trojan, with campaigns spanning multiple continents. [Cyble tracked](https://cyble.com/blog/ermac-android-malware-increasingly-active/) increasingly active distribution across Europe.

**January 2023**: DukeEugene announced [Hook](hook.md), built on Ermac's codebase. Active Ermac campaigns began declining as operators migrated to the more capable successor.

**2024**: [Silent Push uncovered](https://www.silentpush.com/blog/dukeeugene/) 24 active DukeEugene control panels administering services for Ermac, Hook, and related variants, demonstrating that Ermac infrastructure remained partially operational even after Hook's introduction.

**August 2025**: The [Ermac 3.0 source code leaked](https://www.bleepingcomputer.com/news/security/ermac-android-malware-source-code-leak-exposes-banking-trojan-infrastructure/), exposing the full malware infrastructure including C2 panel code and builder tools, mirroring the original Cerberus leak that started the lineage.

## References
