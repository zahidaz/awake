{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"AWAKE","text":"<p>Android Wiki of Attacks, Knowledge &amp; Exploits</p> <p>A comprehensive documentation of Android security vulnerabilities, permission exploits, and malware analysis.</p>"},{"location":"#about","title":"About","text":"<p>AWAKE is a curated knowledge base dedicated to Android security research, documenting various attack vectors, vulnerabilities, and exploitation techniques. This resource serves as a reference for security researchers, penetration testers, and developers interested in understanding Android security mechanisms and their weaknesses.</p>"},{"location":"#what-youll-find-here","title":"What You'll Find Here","text":"<ul> <li>Permission Exploits: Documentation of Android permission system vulnerabilities and bypass techniques</li> <li>Attack Vectors: Analysis of various attack methods targeting Android applications and the OS</li> <li>Malware Analysis: In-depth examination of Android malware families and their behaviors</li> <li>Security Mechanisms: Understanding Android's security features and their limitations</li> <li>Vulnerability Research: Detailed writeups of discovered vulnerabilities</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>This is an evolving documentation project. Contributions, corrections, and additions are welcome.</p>"},{"location":"#disclaimer","title":"Disclaimer","text":"<p>This documentation is provided for educational and defensive security purposes only. The information contained herein should be used responsibly and ethically, in accordance with applicable laws and regulations.</p>"},{"location":"packers/","title":"Android Packers","text":""},{"location":"packers/#overview","title":"Overview","text":"<p>Android packers (also known as protectors or armoring tools) are software solutions that transform APK files to protect their code from reverse engineering, tampering, and analysis. While legitimate developers use packers to protect intellectual property, malware authors frequently abuse these tools to evade detection and hinder analysis.</p>"},{"location":"packers/#how-packers-work","title":"How Packers Work","text":"<p>Packers typically employ multiple layers of protection:</p> <ul> <li>Code encryption: Encrypting DEX files and decrypting at runtime</li> <li>Native code wrapping: Moving critical logic to native libraries</li> <li>Anti-debugging: Detecting and blocking debugger attachment</li> <li>Anti-tampering: Integrity checks to detect modifications</li> <li>Environment detection: Identifying emulators and analysis environments</li> <li>String encryption: Obfuscating sensitive strings</li> <li>Control flow obfuscation: Making code logic difficult to follow</li> </ul>"},{"location":"packers/#categories","title":"Categories","text":""},{"location":"packers/#commercial-packers","title":"Commercial Packers","text":"<p>Enterprise-grade solutions used by legitimate developers for app protection. Often include additional features like licensing and analytics.</p>"},{"location":"packers/#freeopen-source-packers","title":"Free/Open Source Packers","text":"<p>Publicly available tools that provide basic protection capabilities.</p>"},{"location":"packers/#custom-packers","title":"Custom Packers","text":"<p>Proprietary solutions developed by threat actors specifically for malware distribution.</p>"},{"location":"packers/#analysis-challenges","title":"Analysis Challenges","text":"<p>Packed applications present unique challenges for security researchers:</p> <ul> <li>Static analysis tools may fail to extract meaningful information</li> <li>Dynamic analysis requires bypassing anti-analysis checks</li> <li>Multiple unpacking stages may be required</li> <li>Packer-specific knowledge is often necessary</li> </ul>"},{"location":"packers/#research-focus","title":"Research Focus","text":"<p>Each packer page in this wiki documents:</p> <ul> <li>Identification methods and signatures</li> <li>Protection mechanisms employed</li> <li>Unpacking techniques and tools</li> <li>Detection strategies</li> <li>Sample analysis case studies</li> </ul>"},{"location":"packers/#references","title":"References","text":"<ul> <li>Android Unpacking Resources</li> <li>APKiD - Android Application Identifier</li> </ul>"},{"location":"packers/virbox/","title":"Virbox Protector","text":"<p>Virbox Protector is a commercial application shielding solution developed by SenseShield Technology, a Chinese software protection company. While designed for legitimate developers to protect their applications from reverse engineering, Virbox has been observed in sophisticated Android malware campaigns.</p>"},{"location":"packers/virbox/#vendor-information","title":"Vendor Information","text":"Attribute Details Developer SenseShield Technology Origin China Type Commercial Packer/Protector Platforms Android, Windows, Linux, macOS, ARM-Linux Min Android Android 4.0+ (API 14) Architectures ARM V7/V8, x86, x64 Website appsec.virbox.com"},{"location":"packers/virbox/#identification","title":"Identification","text":""},{"location":"packers/virbox/#file-artifacts","title":"File Artifacts","text":"Artifact Description Stub Package Hex-based package name Stub Class Stub app class Extending Application Native Library <code>libvirbox_*.so</code> in assets or lib folder Tag String <code>\"virbox\"</code> string reference"},{"location":"packers/virbox/#native-library-naming-convention","title":"Native Library Naming Convention","text":"<pre><code>libvirbox_a32.so   // ARM 32-bit\nlibvirbox_a64.so   // ARM 64-bit\nlibvirbox_x86.so   // x86\nlibvirbox_x64.so   // x86_64\nlibvirbox_mips.so  // MIPS\nlibvirbox_m64.so   // MIPS64\n</code></pre>"},{"location":"packers/virbox/#native-method-signatures","title":"Native Method Signatures","text":"<p>Obfuscated JNI methods follow this pattern:</p> <pre><code>native void I6f7de22b_00(Context context);\nnative void I6f7de22b_01(Context context, Application app, String className);\nnative void I6f7de22b_02(Activity activity, Bundle bundle);\nnative void I6f7de22b_03(Activity activity);\nnative void I6f7de22b_04(Activity activity);\nnative void I6f7de22b_05(Network network, NetworkCapabilities caps);\nnative boolean I6f7de22b_06();\n</code></pre>"},{"location":"packers/virbox/#protection-mechanisms","title":"Protection Mechanisms","text":""},{"location":"packers/virbox/#dex-protection","title":"DEX Protection","text":""},{"location":"packers/virbox/#dex-encryption","title":"DEX Encryption","text":"<p>Encrypts the entire classes.dex file. Decryption occurs at runtime via native code. Not recommended for Google Play apps as it may fail store checks.</p>"},{"location":"packers/virbox/#dex-virtualization","title":"DEX Virtualization","text":"<p>Converts Dalvik bytecode into proprietary VM instructions:</p> <ol> <li>Original method bytecode is extracted</li> <li>Bytecode is transformed into custom instruction set</li> <li>Custom VM interpreter executes in native layer</li> <li>Original method becomes a stub calling native VM</li> </ol> <p>This defeats static analysis as the bytecode no longer exists in standard Dalvik format.</p>"},{"location":"packers/virbox/#string-encryption","title":"String Encryption","text":"<p>Sensitive strings are encrypted and decrypted at runtime via SDK labels.</p>"},{"location":"packers/virbox/#native-library-protection","title":"Native Library Protection","text":"<ul> <li>Code Section Encryption: Encrypts .text section of .so files</li> <li>Symbol Table Stripping: Removes function names and exports</li> <li>Import/Export Hiding: Obscures dynamic linking information</li> <li>Function Virtualization: Critical functions converted to VM code</li> </ul>"},{"location":"packers/virbox/#runtime-protection-rasp","title":"Runtime Protection (RASP)","text":""},{"location":"packers/virbox/#anti-debugging","title":"Anti-Debugging","text":"<p>Detects debuggers using multiple techniques:</p> <ul> <li>Checks for TracerPid in <code>/proc/self/status</code></li> <li>Detects ptrace attachment</li> <li>Monitors for IDA Pro, gdb, jeb, lldb</li> <li>App exits immediately upon detection</li> </ul>"},{"location":"packers/virbox/#anti-injection","title":"Anti-Injection","text":"<ul> <li>Dual-session ptrace to block external attachment</li> <li>Detects .so injection attempts</li> <li>Monitors for Frida, Xposed hooks</li> </ul>"},{"location":"packers/virbox/#emulator-detection","title":"Emulator Detection","text":"<p>Identifies emulator environments via:</p> <ul> <li>Build properties (ro.product.model, ro.hardware)</li> <li>File system artifacts</li> <li>Hardware characteristics</li> <li>App terminates if emulator detected</li> </ul>"},{"location":"packers/virbox/#root-detection","title":"Root Detection","text":"<p>Checks for:</p> <ul> <li>su binary presence</li> <li>Root management apps</li> <li>Modified system partitions</li> </ul>"},{"location":"packers/virbox/#multi-parallel-detection","title":"Multi-Parallel Detection","text":"<p>Prevents app cloning and multi-account environments.</p>"},{"location":"packers/virbox/#signature-verification","title":"Signature Verification","text":"<p>Validates APK signature against expected developer certificate to prevent repackaging.</p>"},{"location":"packers/virbox/#file-integrity-check","title":"File Integrity Check","text":"<p>Hash verification of APK contents to detect tampering.</p>"},{"location":"packers/virbox/#technical-analysis","title":"Technical Analysis","text":""},{"location":"packers/virbox/#stub-application-structure","title":"Stub Application Structure","text":"<pre><code>package v6f7de22b;\n\nclass app extends Application {\n\n    static String TAG = \"virbox\";\n    static Context appContext;\n\n    String nativeLibPath;\n    String realAppClassName;\n    String newResDir;\n    boolean initialized = false;\n    Application realApplication;\n    Object savedProviders;\n\n    native void I6f7de22b_00(Context context);\n    native void I6f7de22b_01(Context context, Application app, String className);\n    native void I6f7de22b_02(Activity activity, Bundle bundle);\n    native void I6f7de22b_03(Activity activity);\n    native void I6f7de22b_04(Activity activity);\n    native void I6f7de22b_05(Network network, NetworkCapabilities caps);\n    native boolean I6f7de22b_06();\n}\n</code></pre>"},{"location":"packers/virbox/#architecture-detection","title":"Architecture Detection","text":"<pre><code>String getLibrarySuffix(String abi, boolean is64bit) {\n    if (!is64bit) {\n        if (abi.contains(\"armeabi\")) return \"_a32.so\";\n        if (abi.contains(\"arm64\"))   return \"_a64.so\";\n        if (abi.contains(\"x86_64\"))  return \"_x64.so\";\n        if (abi.contains(\"x86\"))     return \"_x86.so\";\n        if (abi.contains(\"mips64\"))  return \"_m64.so\";\n        if (abi.contains(\"mips\"))    return \"_mips.so\";\n    } else {\n        if (abi.contains(\"armeabi\")) return \"_x86.so\";\n        if (abi.contains(\"arm64\") || abi.contains(\"x86_64\")) return \"_x64.so\";\n        if (abi.contains(\"x86\"))     return \"_x86.so\";\n        if (abi.contains(\"mips64\"))  return \"_m64.so\";\n        if (abi.contains(\"mips\"))    return \"_mips.so\";\n    }\n    return \"\";\n}\n</code></pre>"},{"location":"packers/virbox/#native-library-extraction","title":"Native Library Extraction","text":"<pre><code>boolean extractAsset(Context ctx, String assetName, String destDir, String destName) {\n    String destPath = destDir + \"/\" + destName;\n    File dir = new File(destDir);\n    if (!dir.exists()) dir.mkdirs();\n\n    File destFile = new File(destPath);\n    InputStream assetStream = ctx.getAssets().open(assetName);\n\n    if (destFile.exists() &amp;&amp; filesAreEqual(assetStream, new FileInputStream(destFile))) {\n        assetStream.close();\n        return true;\n    }\n\n    destFile.delete();\n    assetStream.close();\n\n    assetStream = ctx.getAssets().open(assetName);\n    FileOutputStream fos = new FileOutputStream(destPath);\n\n    byte[] buffer = new byte[1024];\n    int bytesRead;\n    while ((bytesRead = assetStream.read(buffer)) != -1) {\n        fos.write(buffer, 0, bytesRead);\n    }\n\n    assetStream.close();\n    fos.close();\n\n    destFile.setReadable(true, false);\n    destFile.setExecutable(true, false);\n    destFile.setWritable(false, false);\n\n    return true;\n}\n</code></pre>"},{"location":"packers/virbox/#initialization-attachbasecontext","title":"Initialization (attachBaseContext)","text":"<pre><code>void attachBaseContext(Context base) {\n    super.attachBaseContext(base);\n    appContext = base;\n\n    String abi = Build.CPU_ABI;\n    String libSuffix = getLibrarySuffix(abi, false);\n    String libName = \"libvirbox\" + libSuffix;\n\n    String nativeDir = getApplicationInfo().nativeLibraryDir;\n    String dataDir = getFilesDir().getAbsolutePath();\n\n    if (assetExists(base, libName)) {\n        extractAsset(base, libName, dataDir, libName);\n        this.nativeLibPath = dataDir + \"/\" + libName;\n    } else {\n        this.nativeLibPath = nativeDir + \"/\" + libName;\n    }\n\n    System.load(this.nativeLibPath);\n\n    I6f7de22b_00(base);\n\n    saveProviders();\n\n    this.realAppClassName = getRealApplicationClassName();\n\n    if (this.realAppClassName != null) {\n        Class realAppClass = Class.forName(this.realAppClassName);\n        this.realApplication = (Application) realAppClass.newInstance();\n\n        Method attachMethod = Application.class.getDeclaredMethod(\"attach\", Context.class);\n        attachMethod.setAccessible(true);\n        attachMethod.invoke(this.realApplication, base);\n    }\n\n    I6f7de22b_01(base, this.realApplication, this.realAppClassName);\n\n    registerActivityLifecycleCallbacks(new ActivityLifecycleHandler());\n\n    ConnectivityManager cm = (ConnectivityManager) getSystemService(CONNECTIVITY_SERVICE);\n    cm.registerDefaultNetworkCallback(new NetworkHandler());\n}\n</code></pre>"},{"location":"packers/virbox/#contentprovider-manipulation","title":"ContentProvider Manipulation","text":"<p>Virbox delays ContentProvider initialization to ensure proper unpacking order:</p> <pre><code>void saveProviders() {\n    Class activityThreadClass = Class.forName(\"android.app.ActivityThread\");\n    Method currentMethod = activityThreadClass.getMethod(\"currentActivityThread\");\n    Object activityThread = currentMethod.invoke(null);\n\n    Object boundApp = getField(activityThread, \"mBoundApplication\").get(activityThread);\n    Field providersField = getField(boundApp, \"providers\");\n\n    this.savedProviders = providersField.get(boundApp);\n    providersField.set(boundApp, null);\n}\n\nvoid restoreProviders() {\n    Class activityThreadClass = Class.forName(\"android.app.ActivityThread\");\n    Method currentMethod = activityThreadClass.getMethod(\"currentActivityThread\");\n    Object activityThread = currentMethod.invoke(null);\n\n    Object boundApp = getField(activityThread, \"mBoundApplication\").get(activityThread);\n    getField(boundApp, \"providers\").set(boundApp, this.savedProviders);\n\n    if (this.savedProviders != null) {\n        Method installProviders = activityThreadClass.getDeclaredMethod(\n            \"installContentProviders\", Context.class, List.class);\n        installProviders.setAccessible(true);\n        installProviders.invoke(activityThread, this.realApplication, this.savedProviders);\n        this.savedProviders = null;\n    }\n}\n</code></pre>"},{"location":"packers/virbox/#application-replacement","title":"Application Replacement","text":"<p>Replaces stub Application with real Application in Android internals:</p> <pre><code>void replaceApplication() {\n    Class activityThreadClass = Class.forName(\"android.app.ActivityThread\");\n    Method currentMethod = activityThreadClass.getMethod(\"currentActivityThread\");\n    Object activityThread = currentMethod.invoke(null);\n\n    Field initialAppField = activityThreadClass.getDeclaredField(\"mInitialApplication\");\n    initialAppField.setAccessible(true);\n    if (initialAppField.get(activityThread) == this) {\n        initialAppField.set(activityThread, this.realApplication);\n    }\n\n    Field allAppsField = activityThreadClass.getDeclaredField(\"mAllApplications\");\n    allAppsField.setAccessible(true);\n    List allApps = (List) allAppsField.get(activityThread);\n    for (int i = 0; i &lt; allApps.size(); i++) {\n        if (allApps.get(i) == this) {\n            allApps.set(i, this.realApplication);\n        }\n    }\n\n    Class loadedApkClass;\n    try {\n        loadedApkClass = Class.forName(\"android.app.LoadedApk\");\n    } catch (ClassNotFoundException e) {\n        loadedApkClass = Class.forName(\"android.app.ActivityThread$PackageInfo\");\n    }\n\n    Field appField = loadedApkClass.getDeclaredField(\"mApplication\");\n    appField.setAccessible(true);\n\n    Field resDirField = loadedApkClass.getDeclaredField(\"mResDir\");\n    resDirField.setAccessible(true);\n\n    Field loadedApkField = null;\n    try {\n        loadedApkField = Application.class.getDeclaredField(\"mLoadedApk\");\n    } catch (NoSuchFieldException e) {}\n\n    String[] packageFields = {\"mPackages\", \"mResourcePackages\"};\n\n    for (String fieldName : packageFields) {\n        Field packagesField = activityThreadClass.getDeclaredField(fieldName);\n        packagesField.setAccessible(true);\n        Map packages = (Map) packagesField.get(activityThread);\n\n        for (Object entry : packages.entrySet()) {\n            Object weakRef = ((Map.Entry) entry).getValue();\n            Object loadedApk = ((WeakReference) weakRef).get();\n\n            if (loadedApk != null &amp;&amp; appField.get(loadedApk) == this) {\n                appField.set(loadedApk, this.realApplication);\n\n                if (this.newResDir != null) {\n                    resDirField.set(loadedApk, this.newResDir);\n                }\n\n                if (loadedApkField != null) {\n                    loadedApkField.set(this.realApplication, loadedApk);\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"packers/virbox/#resource-replacement","title":"Resource Replacement","text":"<pre><code>void replaceResources() {\n    if (this.newResDir == null) return;\n\n    AssetManager newAssets = AssetManager.class.getConstructor().newInstance();\n    Method addPath = AssetManager.class.getDeclaredMethod(\"addAssetPath\", String.class);\n    addPath.setAccessible(true);\n\n    int result = (Integer) addPath.invoke(newAssets, this.newResDir);\n    if (result == 0) {\n        throw new IllegalStateException(\"Could not create new AssetManager\");\n    }\n\n    if (Build.VERSION.SDK_INT &lt;= 19) {\n        Method ensureBlocks = AssetManager.class.getDeclaredMethod(\"ensureStringBlocks\");\n        ensureBlocks.setAccessible(true);\n        ensureBlocks.invoke(newAssets);\n    }\n\n    Class resourcesManagerClass = Class.forName(\"android.app.ResourcesManager\");\n    Method getInstance = resourcesManagerClass.getDeclaredMethod(\"getInstance\");\n    Object resourcesManager = getInstance.invoke(null);\n\n    Collection resourcesList;\n    try {\n        Field activeField = resourcesManagerClass.getDeclaredField(\"mActiveResources\");\n        activeField.setAccessible(true);\n        resourcesList = ((ArrayMap) activeField.get(resourcesManager)).values();\n    } catch (NoSuchFieldException e) {\n        Field refsField = resourcesManagerClass.getDeclaredField(\"mResourceReferences\");\n        refsField.setAccessible(true);\n        resourcesList = (Collection) refsField.get(resourcesManager);\n    }\n\n    for (Object ref : resourcesList) {\n        Resources res = (Resources) ((WeakReference) ref).get();\n\n        try {\n            Field assetsField = Resources.class.getDeclaredField(\"mAssets\");\n            assetsField.setAccessible(true);\n            assetsField.set(res, newAssets);\n        } catch (NoSuchFieldException e) {\n            Field implField = Resources.class.getDeclaredField(\"mResourcesImpl\");\n            implField.setAccessible(true);\n            Object impl = implField.get(res);\n\n            Field implAssetsField = impl.getClass().getDeclaredField(\"mAssets\");\n            implAssetsField.setAccessible(true);\n            implAssetsField.set(impl, newAssets);\n        }\n\n        res.updateConfiguration(res.getConfiguration(), res.getDisplayMetrics());\n    }\n}\n</code></pre>"},{"location":"packers/virbox/#oncreate-execution","title":"onCreate Execution","text":"<pre><code>void onCreate() {\n    if (this.realApplication != null) {\n        replaceApplication();\n        replaceResources();\n        restoreProviders();\n    }\n\n    super.onCreate();\n\n    if (this.realApplication != null) {\n        this.realApplication.onCreate();\n    }\n}\n</code></pre>"},{"location":"packers/virbox/#activity-lifecycle-monitoring","title":"Activity Lifecycle Monitoring","text":"<pre><code>class ActivityLifecycleHandler implements ActivityLifecycleCallbacks {\n    Handler handler = new Handler();\n    Runnable hijackDetector;\n\n    void cancelHijackCheck() {\n        if (hijackDetector != null) {\n            handler.removeCallbacks(hijackDetector);\n            hijackDetector = null;\n        }\n    }\n\n    void scheduleHijackCheck(Activity activity) {\n        if (activity == null || activity.isFinishing() || activity.isDestroyed()) {\n            return;\n        }\n\n        hijackDetector = new Runnable() {\n            WeakReference&lt;Activity&gt; activityRef = new WeakReference&lt;&gt;(activity);\n\n            void run() {\n                Activity act = activityRef.get();\n                if (act != null &amp;&amp; !act.isFinishing() &amp;&amp; !act.isDestroyed()) {\n                    String msg = isChineseLocale()\n                        ? \"\u5e94\u7528\u5df2\u88ab\u5207\u6362\u81f3\u540e\u53f0\"\n                        : \"App has been switched to background\";\n                    Toast.makeText(act, msg, Toast.LENGTH_SHORT).show();\n                }\n            }\n        };\n\n        handler.postDelayed(hijackDetector, 1000);\n    }\n\n    void onActivityCreated(Activity activity, Bundle state) {\n        I6f7de22b_02(activity, state);\n    }\n\n    void onActivityStarted(Activity activity) {\n        I6f7de22b_03(activity);\n    }\n\n    void onActivityResumed(Activity activity) {\n        cancelHijackCheck();\n    }\n\n    void onActivityPaused(Activity activity) {\n        if (I6f7de22b_06()) {\n            scheduleHijackCheck(activity);\n        }\n        I6f7de22b_04(activity);\n    }\n}\n</code></pre>"},{"location":"packers/virbox/#network-monitoring","title":"Network Monitoring","text":"<pre><code>class NetworkHandler extends ConnectivityManager.NetworkCallback {\n    void onCapabilitiesChanged(Network network, NetworkCapabilities caps) {\n        I6f7de22b_05(network, caps);\n    }\n}\n</code></pre>"},{"location":"packers/virbox/#reflection-helper","title":"Reflection Helper","text":"<pre><code>Field getField(Object obj, String fieldName) {\n    Class cls = obj.getClass();\n    while (cls != null) {\n        try {\n            Field field = cls.getDeclaredField(fieldName);\n            field.setAccessible(true);\n            return field;\n        } catch (NoSuchFieldException e) {\n            cls = cls.getSuperclass();\n        }\n    }\n    throw new IllegalStateException(fieldName);\n}\n</code></pre>"},{"location":"packers/virbox/#reflection-targets-summary","title":"Reflection Targets Summary","text":""},{"location":"packers/virbox/#activitythread","title":"ActivityThread","text":"Field Purpose <code>mInitialApplication</code> Primary Application reference <code>mAllApplications</code> List of all Application instances <code>mBoundApplication</code> AppBindData containing providers <code>mPackages</code> Package name to LoadedApk map <code>mResourcePackages</code> Resource package map"},{"location":"packers/virbox/#loadedapk","title":"LoadedApk","text":"Field Purpose <code>mApplication</code> Application instance reference <code>mResDir</code> Resource directory path"},{"location":"packers/virbox/#resourcesmanager","title":"ResourcesManager","text":"Field Purpose <code>mActiveResources</code> Active Resources map (older Android) <code>mResourceReferences</code> Resource references (newer Android)"},{"location":"packers/virbox/#appbinddata","title":"AppBindData","text":"Field Purpose <code>providers</code> List of ContentProvider info"},{"location":"packers/virbox/#malware-abuse","title":"Malware Abuse","text":""},{"location":"packers/virbox/#klopatra-banking-trojan-2025","title":"Klopatra Banking Trojan (2025)","text":"<p>Virbox was discovered protecting the Klopatra Android banking trojan targeting Turkish financial institutions.</p> <p>Observations:</p> <ul> <li>Described as \"rarely seen in the Android threat landscape\"</li> <li>Combined with native libraries for maximum evasion</li> <li>Analysis only succeeded via unprotected development build</li> <li>Protection \"drastically increases time and expertise required\"</li> </ul>"},{"location":"packers/virbox/#references","title":"References","text":"<ul> <li>Virbox Protector Documentation</li> <li>Virbox Android Protection</li> <li>Virbox Best Practices</li> <li>SenseShield GitHub</li> <li>Klopatra Analysis - Cleafy Labs</li> </ul>"},{"location":"permissions/","title":"Android Dangerous Permissions","text":""},{"location":"permissions/#overview","title":"Overview","text":"<p>Android's permission system is designed to protect user privacy and system security by controlling access to sensitive data and device features. Permissions are categorized into different protection levels, with dangerous permissions being those that could potentially affect user privacy or device operation.</p> <p>Dangerous permissions are runtime permissions that must be explicitly granted by the user. However, these permissions are frequently abused by malicious applications and are common targets for exploitation.</p>"},{"location":"permissions/#permission-model","title":"Permission Model","text":"<p>Starting from Android 6.0 (API level 23), dangerous permissions must be requested at runtime rather than being granted at install time. Users can revoke these permissions at any time through system settings.</p>"},{"location":"permissions/#protection-levels","title":"Protection Levels","text":"<ul> <li>Normal: Low-risk permissions granted automatically</li> <li>Dangerous: Runtime permissions that access sensitive user data</li> <li>Signature: Only granted to apps signed with the same certificate</li> <li>SignatureOrSystem: Reserved for system apps</li> </ul>"},{"location":"permissions/#dangerous-permission-groups","title":"Dangerous Permission Groups","text":"<p>Android dangerous permissions are organized into logical groups. Granting one permission in a group automatically grants all other permissions in that same group (for targetSdkVersion &lt; 23).</p>"},{"location":"permissions/#calendar","title":"Calendar","text":"<p>Access to calendar events and reminders.</p>"},{"location":"permissions/#call-log","title":"Call Log","text":"<p>Read and write access to call history.</p>"},{"location":"permissions/#camera","title":"Camera","text":"<p>Access to device cameras for capturing photos and videos.</p>"},{"location":"permissions/#contacts","title":"Contacts","text":"<p>Access to user contact information and accounts.</p>"},{"location":"permissions/#location","title":"Location","text":"<p>Access to device location through GPS, network, or other sources.</p>"},{"location":"permissions/#microphone","title":"Microphone","text":"<p>Access to audio capture from device microphones.</p>"},{"location":"permissions/#phone","title":"Phone","text":"<p>Access to phone state, call management, and telephony features.</p>"},{"location":"permissions/#sensors","title":"Sensors","text":"<p>Access to body sensor data like heart rate monitors.</p>"},{"location":"permissions/#activity-recognition","title":"Activity Recognition","text":"<p>Access to user physical activity data.</p>"},{"location":"permissions/#sms","title":"SMS","text":"<p>Send, receive, and read SMS and MMS messages.</p>"},{"location":"permissions/#storage","title":"Storage","text":"<p>Read and write access to external storage and media files.</p>"},{"location":"permissions/#nearby-devices","title":"Nearby Devices","text":"<p>Access to Bluetooth, Wi-Fi, and Ultra-Wideband for device discovery.</p>"},{"location":"permissions/#common-abuse-patterns","title":"Common Abuse Patterns","text":"<p>Dangerous permissions are frequently abused through:</p> <ul> <li>Over-permission: Requesting more permissions than functionally necessary</li> <li>Permission creep: Gradually requesting additional permissions through updates</li> <li>Social engineering: Misleading users about permission purposes</li> <li>Exploitation: Leveraging granted permissions for unintended purposes</li> <li>Privilege escalation: Chaining multiple permissions to gain elevated access</li> </ul>"},{"location":"permissions/#security-considerations","title":"Security Considerations","text":"<p>When analyzing applications or permission usage:</p> <ol> <li>Principle of least privilege: Apps should only request necessary permissions</li> <li>Purpose limitation: Permissions should only be used for stated purposes</li> <li>Temporal constraints: Consider when and how frequently permissions are accessed</li> <li>Data minimization: Limit the scope and duration of sensitive data access</li> <li>User transparency: Users should understand why permissions are needed</li> </ol>"},{"location":"permissions/#research-focus","title":"Research Focus","text":"<p>Each permission page in this wiki documents:</p> <ul> <li>Technical implementation details</li> <li>Known vulnerabilities and exploits</li> <li>Abuse patterns observed in malware</li> <li>Bypass techniques and escalation vectors</li> <li>Defensive recommendations</li> <li>Real-world case studies</li> </ul>"},{"location":"permissions/#references","title":"References","text":"<ul> <li>Android Permissions Overview</li> <li>Android Manifest Permissions</li> <li>Permission Best Practices</li> </ul>"},{"location":"permissions/activity-recognition/","title":"Activity Recognition Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/activity-recognition/activity-recognition/","title":"ACTIVITY_RECOGNITION","text":"<p>Content to be added.</p>"},{"location":"permissions/calendar/read-calendar/","title":"READ_CALENDAR","text":"<p>Content to be added.</p>"},{"location":"permissions/calendar/write-calendar/","title":"WRITE_CALENDAR","text":"<p>Content to be added.</p>"},{"location":"permissions/call-log/","title":"Call Log Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/call-log/process-outgoing-calls/","title":"PROCESS_OUTGOING_CALLS","text":"<p>Content to be added.</p>"},{"location":"permissions/call-log/read-call-log/","title":"READ_CALL_LOG","text":"<p>Content to be added.</p>"},{"location":"permissions/call-log/write-call-log/","title":"WRITE_CALL_LOG","text":"<p>Content to be added.</p>"},{"location":"permissions/camera/","title":"Camera Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/camera/camera/","title":"CAMERA","text":"<p>Content to be added.</p>"},{"location":"permissions/contacts/","title":"Contacts Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/contacts/get-accounts/","title":"GET_ACCOUNTS","text":"<p>Content to be added.</p>"},{"location":"permissions/contacts/read-contacts/","title":"READ_CONTACTS","text":"<p>Content to be added.</p>"},{"location":"permissions/contacts/write-contacts/","title":"WRITE_CONTACTS","text":"<p>Content to be added.</p>"},{"location":"permissions/location/","title":"Location Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/location/access-background-location/","title":"ACCESS_BACKGROUND_LOCATION","text":"<p>Content to be added.</p>"},{"location":"permissions/location/access-coarse-location/","title":"ACCESS_COARSE_LOCATION","text":"<p>Content to be added.</p>"},{"location":"permissions/location/access-fine-location/","title":"ACCESS_FINE_LOCATION","text":"<p>Content to be added.</p>"},{"location":"permissions/microphone/","title":"Microphone Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/microphone/record-audio/","title":"RECORD_AUDIO","text":"<p>Content to be added.</p>"},{"location":"permissions/nearby-devices/","title":"Nearby Devices Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/nearby-devices/bluetooth-advertise/","title":"BLUETOOTH_ADVERTISE","text":"<p>Content to be added.</p>"},{"location":"permissions/nearby-devices/bluetooth-connect/","title":"BLUETOOTH_CONNECT","text":"<p>Content to be added.</p>"},{"location":"permissions/nearby-devices/bluetooth-scan/","title":"BLUETOOTH_SCAN","text":"<p>Content to be added.</p>"},{"location":"permissions/nearby-devices/nearby-wifi-devices/","title":"NEARBY_WIFI_DEVICES","text":"<p>Content to be added.</p>"},{"location":"permissions/nearby-devices/uwb-ranging/","title":"UWB_RANGING","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/","title":"Phone Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/accept-handover/","title":"ACCEPT_HANDOVER","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/add-voicemail/","title":"ADD_VOICEMAIL","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/answer-phone-calls/","title":"ANSWER_PHONE_CALLS","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/call-phone/","title":"CALL_PHONE","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/read-phone-numbers/","title":"READ_PHONE_NUMBERS","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/read-phone-state/","title":"READ_PHONE_STATE","text":"<p>Content to be added.</p>"},{"location":"permissions/phone/use-sip/","title":"USE_SIP","text":"<p>Content to be added.</p>"},{"location":"permissions/sensors/","title":"Sensors Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/sensors/body-sensors-background/","title":"BODY_SENSORS_BACKGROUND","text":"<p>Content to be added.</p>"},{"location":"permissions/sensors/body-sensors/","title":"BODY_SENSORS","text":"<p>Content to be added.</p>"},{"location":"permissions/sms/","title":"SMS Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/sms/read-sms/","title":"READ_SMS","text":"<p>Content to be added.</p>"},{"location":"permissions/sms/receive-mms/","title":"RECEIVE_MMS","text":"<p>Content to be added.</p>"},{"location":"permissions/sms/receive-sms/","title":"RECEIVE_SMS","text":"<p>Content to be added.</p>"},{"location":"permissions/sms/receive-wap-push/","title":"RECEIVE_WAP_PUSH","text":"<p>Content to be added.</p>"},{"location":"permissions/sms/send-sms/","title":"SEND_SMS","text":"<p>Content to be added.</p>"},{"location":"permissions/storage/","title":"Storage Permissions","text":"<p>Content to be added.</p>"},{"location":"permissions/storage/read-external-storage/","title":"READ_EXTERNAL_STORAGE","text":"<p>Content to be added.</p>"},{"location":"permissions/storage/read-media-audio/","title":"READ_MEDIA_AUDIO","text":"<p>Content to be added.</p>"},{"location":"permissions/storage/read-media-images/","title":"READ_MEDIA_IMAGES","text":"<p>Content to be added.</p>"},{"location":"permissions/storage/read-media-video/","title":"READ_MEDIA_VIDEO","text":"<p>Content to be added.</p>"},{"location":"permissions/storage/write-external-storage/","title":"WRITE_EXTERNAL_STORAGE","text":"<p>Content to be added.</p>"}]}