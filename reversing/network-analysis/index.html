
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Android Wiki of Attacks, Knowledge & Exploits">
      
      
      
        <link rel="canonical" href="https://zahidaz.github.io/awake/reversing/network-analysis/">
      
      
        <link rel="prev" href="../patching/">
      
      
        <link rel="next" href="../frameworks/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Network Analysis - AWAKE</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--technique:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M11%202v2.07A8%208%200%200%200%204.07%2011H2v2h2.07A8%208%200%200%200%2011%2019.93V22h2v-2.07A8%208%200%200%200%2019.93%2013H22v-2h-2.07A8%208%200%200%200%2013%204.07V2m-2%204.08V8h2V6.09c2.5.41%204.5%202.41%204.92%204.91H16v2h1.91c-.41%202.5-2.41%204.5-4.91%204.92V16h-2v1.91C8.5%2017.5%206.5%2015.5%206.08%2013H8v-2H6.09C6.5%208.5%208.5%206.5%2011%206.08M12%2011a1%201%200%200%200-1%201%201%201%200%200%200%201%201%201%201%200%200%200%201-1%201%201%200%200%200-1-1%22/%3E%3C/svg%3E');--md-admonition-icon--malware:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M14%2012h-4v-2h4m0%206h-4v-2h4m6-6h-2.81a6%206%200%200%200-1.82-1.96L17%204.41%2015.59%203l-2.17%202.17a6%206%200%200%200-2.83%200L8.41%203%207%204.41l1.62%201.63C7.88%206.55%207.26%207.22%206.81%208H4v2h2.09c-.05.33-.09.66-.09%201v1H4v2h2v1c0%20.34.04.67.09%201H4v2h2.81c1.04%201.79%202.97%203%205.19%203s4.15-1.21%205.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20z%22/%3E%3C/svg%3E');--md-admonition-icon--bypass:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M1%204.27%202.28%203%2020.5%2021.22l-1.27%201.28L17%2020.25c-1.43%201.32-3.13%202.29-5%202.75-5.16-1.26-9-6.45-9-12V6.27zM12%201l9%204v6c0%202.28-.65%204.5-1.77%206.41L5.65%203.82z%22/%3E%3C/svg%3E');--md-admonition-icon--frida:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M18%206a3.99%203.99%200%200%201-3%203.86V17a5%205%200%200%201-5%205%205%205%200%200%201-5-5v-5l5%205H7a3%203%200%200%200%203%203%203%203%200%200%200%203-3V9.86c-1.77-.46-3-2.06-3-3.89C10%203.76%2011.8%202%2014%202c2.22%200%204%201.79%204%204m-4%202a2%202%200%200%200%202-2%202%202%200%200%200-2-2%202%202%200%200%200-2%202%202%202%200%200%200%202%202%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#network-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AWAKE" class="md-header__button md-logo" aria-label="AWAKE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AWAKE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Network Analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zahidaz/awake" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zahidaz/awake
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../attacks/" class="md-tabs__link">
          
  
  
    
  
  Attack Techniques

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../malware/" class="md-tabs__link">
          
  
  
    
  
  Malware

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../grayware/" class="md-tabs__link">
          
  
  
    
  
  Grayware

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../platform-abuse/" class="md-tabs__link">
          
  
  
    
  
  Platform Abuse

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Reversing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../packers/" class="md-tabs__link">
          
  
  
    
  
  Packers

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../industry/" class="md-tabs__link">
          
  
  
    
  
  Industry

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../resources/" class="md-tabs__link">
          
  
  
    
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AWAKE" class="md-nav__button md-logo" aria-label="AWAKE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AWAKE
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zahidaz/awake" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zahidaz/awake
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../attacks/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Attack Techniques
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Attack Techniques
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Activities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Activities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/overlay-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overlay Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/tapjacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tapjacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/task-affinity-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task Affinity Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/accessibility-abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accessibility Abuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/notification-listener-abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notification Listener Abuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Broadcast Receivers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Broadcast Receivers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/broadcast-theft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Broadcast Theft
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/sms-interception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SMS Interception
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Content Providers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Content Providers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/content-provider-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content Provider Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Intents
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Intents
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/deep-link-exploitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deep Link Exploitation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/intent-hijacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Intent Hijacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    WebViews
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    WebViews
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/webview-exploitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WebView Exploitation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cross-Cutting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cross-Cutting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/automated-transfer-systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Transfer Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/c2-techniques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C2 Communication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/clipboard-hijacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clipboard Hijacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/device-admin-abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Device Admin Abuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/dynamic-code-loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dynamic Code Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/fake-biometric-prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fake Biometric Prompts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/keylogging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keylogging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/nfc-relay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NFC Relay
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/persistence-techniques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persistence Techniques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/phishing-techniques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phishing Techniques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/ai-assisted-malware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI-Assisted Malware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/app-collusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App Collusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/app-virtualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App Virtualization Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/mass-malware-generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mass Malware Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/play-store-evasion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Play Store Evasion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/runtime-permission-manipulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Permission Manipulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/screen-capture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Screen Capture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attacks/work-profile-abuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Work Profile Abuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../malware/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Malware
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Malware
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/timeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Timeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/naming-conventions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Naming Conventions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/threat-actors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Threat Actors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../malware/families/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Families
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Families
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/albiriox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Albiriox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/alien/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alien
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/anatsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anatsa
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/antidot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Antidot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/anubis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anubis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/aridspy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AridSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/bankbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BankBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/bingomod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BingoMod
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/blankbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BlankBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/bonespy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BoneSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/brata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BRATA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/brokewell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brokewell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/btmob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BTMOB RAT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/cerberus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cerberus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/chameleon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chameleon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/copybara/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Copybara
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/crocodilus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Crocodilus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/dchspy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DCHSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/devixor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DeVixor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/eaglemsgspy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EagleMsgSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/ermac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ermac
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/fakecalls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fakecalls
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/finspy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FinSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/firescam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FireScam
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/flubot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FluBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/fluhorse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FluHorse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/frogblight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Frogblight
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/gigabud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gigabud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/godfather/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GodFather
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/goldpickaxe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GoldPickaxe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/goldoson/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goldoson
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/grifthorse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GriftHorse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/guardzoo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GuardZoo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/gustuff/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gustuff
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/harly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Harly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/hermit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hermit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/herodotus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Herodotus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/hydra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hydra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/joker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Joker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/klopatra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Klopatra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/kospy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KoSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/lightspy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LightSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/mamont/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mamont
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/mandrake/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mandrake
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/medusa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Medusa
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/moqhao/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MoqHao
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/necro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Necro
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/ngate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NGate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/octo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Octo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/pegasus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pegasus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/pixpirate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PixPirate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/pjobrat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PJobRAT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/plaingnome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PlainGnome
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/predator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Predator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/rafelrat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rafel RAT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/raton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RatOn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/sharkbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SharkBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/soumnibot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SoumniBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/sparkcat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SparkCat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/spyagent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpyAgent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/spyloan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpyLoan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/spynote/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpyNote
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/sturnus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sturnus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/toxicpanda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ToxicPanda
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/triada/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Triada
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/trickmo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TrickMo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/tsarbot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TsarBot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/vultur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vultur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/xenomorph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xenomorph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../malware/families/zanubis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zanubis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../grayware/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Grayware
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Grayware
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../platform-abuse/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Platform Abuse
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Platform Abuse
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platform-abuse/app-sandbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App Sandbox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platform-abuse/selinux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SELinux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platform-abuse/verified-boot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Verified Boot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platform-abuse/keystore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keystore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platform-abuse/play-integrity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Play Integrity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platform-abuse/biometric-auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Biometric Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Permissions
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Permissions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/calendar/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Calendar
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_2" id="__nav_5_8_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Calendar
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/calendar/read-calendar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_CALENDAR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/calendar/write-calendar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WRITE_CALENDAR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/call-log/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Call Log
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_3" id="__nav_5_8_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Call Log
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/call-log/process-outgoing-calls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PROCESS_OUTGOING_CALLS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/call-log/read-call-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_CALL_LOG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/call-log/write-call-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WRITE_CALL_LOG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/camera/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Camera
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_4" id="__nav_5_8_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Camera
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/camera/camera/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CAMERA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/contacts/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Contacts
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_5" id="__nav_5_8_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contacts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/contacts/get-accounts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GET_ACCOUNTS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/contacts/read-contacts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_CONTACTS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/contacts/write-contacts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WRITE_CONTACTS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/location/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Location
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_6" id="__nav_5_8_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Location
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/location/access-background-location/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ACCESS_BACKGROUND_LOCATION
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/location/access-coarse-location/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ACCESS_COARSE_LOCATION
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/location/access-fine-location/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ACCESS_FINE_LOCATION
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/microphone/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Microphone
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_7" id="__nav_5_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Microphone
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/microphone/record-audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RECORD_AUDIO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/phone/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Phone
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_8" id="__nav_5_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Phone
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/accept-handover/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ACCEPT_HANDOVER
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/add-voicemail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADD_VOICEMAIL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/answer-phone-calls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ANSWER_PHONE_CALLS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/call-phone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CALL_PHONE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/read-phone-numbers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_PHONE_NUMBERS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/read-phone-state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_PHONE_STATE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/phone/use-sip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    USE_SIP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/sensors/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Sensors
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_9" id="__nav_5_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sensors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sensors/body-sensors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BODY_SENSORS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sensors/body-sensors-background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BODY_SENSORS_BACKGROUND
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/activity-recognition/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Activity Recognition
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_10" id="__nav_5_8_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Activity Recognition
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/activity-recognition/activity-recognition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ACTIVITY_RECOGNITION
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/sms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    SMS
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_11" id="__nav_5_8_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    SMS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sms/read-sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_SMS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sms/receive-mms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RECEIVE_MMS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sms/receive-sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RECEIVE_SMS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sms/receive-wap-push/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RECEIVE_WAP_PUSH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/sms/send-sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SEND_SMS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_12" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/storage/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_12" id="__nav_5_8_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Storage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/storage/read-external-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_EXTERNAL_STORAGE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/storage/read-media-audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_MEDIA_AUDIO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/storage/read-media-images/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_MEDIA_IMAGES
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/storage/read-media-video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    READ_MEDIA_VIDEO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/storage/write-external-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WRITE_EXTERNAL_STORAGE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/nearby-devices/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Nearby Devices
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_13" id="__nav_5_8_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Nearby Devices
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/nearby-devices/bluetooth-advertise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BLUETOOTH_ADVERTISE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/nearby-devices/bluetooth-connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BLUETOOTH_CONNECT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/nearby-devices/bluetooth-scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BLUETOOTH_SCAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/nearby-devices/nearby-wifi-devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NEARBY_WIFI_DEVICES
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/nearby-devices/uwb-ranging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UWB_RANGING
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/special/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Special Permissions
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_14" id="__nav_5_8_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Special Permissions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/bind-accessibility-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIND_ACCESSIBILITY_SERVICE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/bind-device-admin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIND_DEVICE_ADMIN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/bind-notification-listener-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIND_NOTIFICATION_LISTENER_SERVICE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/manage-external-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MANAGE_EXTERNAL_STORAGE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/package-usage-stats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PACKAGE_USAGE_STATS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/request-delete-packages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REQUEST_DELETE_PACKAGES
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/request-install-packages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REQUEST_INSTALL_PACKAGES
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/system-alert-window/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SYSTEM_ALERT_WINDOW
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/use-full-screen-intent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    USE_FULL_SCREEN_INTENT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/special/write-settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WRITE_SETTINGS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8_15" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../permissions/normal/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Normal (Abusable)
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8_15" id="__nav_5_8_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    Normal (Abusable)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/normal/foreground-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FOREGROUND_SERVICE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/normal/internet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    INTERNET
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/normal/query-all-packages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QUERY_ALL_PACKAGES
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/normal/receive-boot-completed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RECEIVE_BOOT_COMPLETED
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/normal/request-ignore-battery-optimizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REQUEST_IGNORE_BATTERY_OPTIMIZATIONS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../permissions/normal/wake-lock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WAKE_LOCK
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Reversing
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reversing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../static-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Static Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dynamic Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hooking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hooking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../patching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Patching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Network Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traffic-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traffic Interception
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-setup-mitmproxy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proxy Setup: mitmproxy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-setup-burp-suite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proxy Setup: Burp Suite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Certificate Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning Bypass
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#universal-ssl-pinning-bypass-with-frida" class="md-nav__link">
    <span class="md-ellipsis">
      
        Universal SSL Pinning Bypass with Frida
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objection-ssl-pinning-disable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objection SSL Pinning Disable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-bypass-by-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning Bypass by Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-pinning-detection-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Certificate Pinning Detection Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-bypass-by-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning Bypass by Implementation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c2-protocol-identification" class="md-nav__link">
    <span class="md-ellipsis">
      
        C2 Protocol Identification
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C2 Protocol Identification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-the-protocol-from-captured-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identifying the Protocol from Captured Traffic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-analysis-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Protocol Analysis Workflow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-c2-protocol-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common C2 Protocol Patterns
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common C2 Protocol Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-rest-polling" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTP REST Polling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#websocket-persistent-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebSocket Persistent Connections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telegram-bot-api-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Telegram Bot API Traffic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firebase-cloud-messaging-wake-ups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Firebase Cloud Messaging Wake-ups
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-tunneling-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Tunneling Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbeat-intervals-by-family-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Heartbeat Intervals by Family Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-types-visible-in-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Types Visible in Traffic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exfiltration-upload-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exfiltration Upload Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bot-panel-url-fingerprints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bot Panel URL Fingerprints
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-generation-algorithms-dga" class="md-nav__link">
    <span class="md-ellipsis">
      
        Domain Generation Algorithms (DGA)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exfiltration-channel-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exfiltration Channel Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traffic Encryption
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traffic Encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hooking-javaxcryptocipher-for-plaintext-capture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hooking javax.crypto.Cipher for Plaintext Capture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hooking-okhttp-interceptors-for-requestresponse-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hooking OkHttp Interceptors for Request/Response Logging
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-protocol-key-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Protocol Key Extraction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frida-scripts-for-network-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        Frida Scripts for Network Interception
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Frida Scripts for Network Interception">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#httpurlconnection-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        HttpURLConnection Hook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#websocket-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebSocket Interception
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#native-ssl_write-ssl_read-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Native SSL_write / SSL_read Hook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-resolution-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Resolution Hook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telegram-bot-api-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        Telegram Bot API Interception
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-analysis-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traffic Analysis Checklist
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traffic Analysis Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registration-beacon" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registration Beacon
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbeat-interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Heartbeat Interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exfiltration-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exfiltration Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitmproxy-scripting" class="md-nav__link">
    <span class="md-ellipsis">
      
        mitmproxy Scripting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mitmproxy Scripting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c2-traffic-decoder-addon" class="md-nav__link">
    <span class="md-ellipsis">
      
        C2 Traffic Decoder Addon
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ioc-extraction-from-network-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        IOC Extraction from Network Traffic
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IOC Extraction from Network Traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-to-extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        What to Extract
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bot-registration-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bot Registration Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-polling-pattern-identification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Polling Pattern Identification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inject-kit-url-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inject Kit URL Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-ioc-extraction-with-mitmproxy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated IOC Extraction with mitmproxy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ioc-extraction-from-raw-packet-captures" class="md-nav__link">
    <span class="md-ellipsis">
      
        IOC Extraction from Raw Packet Captures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ioc-pivot-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        IOC Pivot Points
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../frameworks/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Development Frameworks
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_7" id="__nav_6_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development Frameworks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/appinventor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AppInventor / Kodular
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/b4a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    B4A
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/cocos2d-x/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cocos2d-x
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/compose-multiplatform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compose Multiplatform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/cordova/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cordova / Ionic / Capacitor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/corona/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Corona / Solar2D
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/defold/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Defold
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/delphi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Delphi / RAD Studio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/felgo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Felgo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/flutter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flutter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/gamemaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GameMaker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/gdevelop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GDevelop
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/godot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Godot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/kivy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kivy (Python)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/kotlin-multiplatform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kotlin Multiplatform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/libgdx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    libGDX
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/nativescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NativeScript
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/pwa-twa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PWA / TWA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/qt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Qt for Android
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/react-native/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    React Native
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/renpy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ren'Py
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/rpgmaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RPG Maker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/titanium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Titanium
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/uni-app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    uni-app
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/unity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/unreal-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unreal Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/xamarin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xamarin / .NET MAUI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../packers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Packers
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Packers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/appdome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Appdome
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/appsealing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AppSealing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/arxan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arxan (Digital.ai)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/chinese-packers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chinese Packers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/dexguard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DexGuard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/dexprotector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DexProtector
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/liapp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LIAPP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/promon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Promon SHIELD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/r8-proguard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    R8 / ProGuard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/verimatrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Verimatrix XTD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/virbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virbox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../packers/zshield/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    zShield (Zimperium)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../industry/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Industry
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Industry
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../industry/security-companies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Companies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../resources/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traffic-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traffic Interception
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-setup-mitmproxy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proxy Setup: mitmproxy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-setup-burp-suite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proxy Setup: Burp Suite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Certificate Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning Bypass
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#universal-ssl-pinning-bypass-with-frida" class="md-nav__link">
    <span class="md-ellipsis">
      
        Universal SSL Pinning Bypass with Frida
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objection-ssl-pinning-disable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objection SSL Pinning Disable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-bypass-by-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning Bypass by Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-pinning-detection-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Certificate Pinning Detection Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-bypass-by-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning Bypass by Implementation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c2-protocol-identification" class="md-nav__link">
    <span class="md-ellipsis">
      
        C2 Protocol Identification
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C2 Protocol Identification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-the-protocol-from-captured-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identifying the Protocol from Captured Traffic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-analysis-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Protocol Analysis Workflow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-c2-protocol-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common C2 Protocol Patterns
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common C2 Protocol Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-rest-polling" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTP REST Polling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#websocket-persistent-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebSocket Persistent Connections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telegram-bot-api-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Telegram Bot API Traffic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firebase-cloud-messaging-wake-ups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Firebase Cloud Messaging Wake-ups
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-tunneling-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Tunneling Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbeat-intervals-by-family-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Heartbeat Intervals by Family Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-types-visible-in-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Types Visible in Traffic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exfiltration-upload-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exfiltration Upload Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bot-panel-url-fingerprints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bot Panel URL Fingerprints
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-generation-algorithms-dga" class="md-nav__link">
    <span class="md-ellipsis">
      
        Domain Generation Algorithms (DGA)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exfiltration-channel-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exfiltration Channel Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traffic Encryption
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traffic Encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hooking-javaxcryptocipher-for-plaintext-capture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hooking javax.crypto.Cipher for Plaintext Capture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hooking-okhttp-interceptors-for-requestresponse-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hooking OkHttp Interceptors for Request/Response Logging
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-protocol-key-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Protocol Key Extraction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frida-scripts-for-network-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        Frida Scripts for Network Interception
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Frida Scripts for Network Interception">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#httpurlconnection-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        HttpURLConnection Hook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#websocket-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebSocket Interception
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#native-ssl_write-ssl_read-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Native SSL_write / SSL_read Hook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-resolution-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNS Resolution Hook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telegram-bot-api-interception" class="md-nav__link">
    <span class="md-ellipsis">
      
        Telegram Bot API Interception
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-analysis-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traffic Analysis Checklist
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Traffic Analysis Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registration-beacon" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registration Beacon
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbeat-interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Heartbeat Interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exfiltration-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exfiltration Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitmproxy-scripting" class="md-nav__link">
    <span class="md-ellipsis">
      
        mitmproxy Scripting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mitmproxy Scripting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c2-traffic-decoder-addon" class="md-nav__link">
    <span class="md-ellipsis">
      
        C2 Traffic Decoder Addon
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ioc-extraction-from-network-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      
        IOC Extraction from Network Traffic
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IOC Extraction from Network Traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-to-extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        What to Extract
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bot-registration-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bot Registration Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-polling-pattern-identification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Polling Pattern Identification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inject-kit-url-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inject Kit URL Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-ioc-extraction-with-mitmproxy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated IOC Extraction with mitmproxy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ioc-extraction-from-raw-packet-captures" class="md-nav__link">
    <span class="md-ellipsis">
      
        IOC Extraction from Raw Packet Captures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ioc-pivot-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        IOC Pivot Points
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="network-analysis">Network Analysis<a class="headerlink" href="#network-analysis" title="Permanent link">&para;</a></h1>
<p>Intercepting, decrypting, and analyzing network traffic between the malware and its C2 server. Reveals command protocols, exfiltration channels, target lists, and infrastructure. Often the fastest path to understanding a sample's purpose and operator identity.</p>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h2>
<h3 id="traffic-interception">Traffic Interception<a class="headerlink" href="#traffic-interception" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Root Required</th>
<th>HTTPS</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Burp Suite / mitmproxy as Wi-Fi proxy</td>
<td>No</td>
<td>With cert install</td>
<td>Standard approach. Set device proxy to host IP.</td>
</tr>
<tr>
<td>iptables redirect</td>
<td>Yes</td>
<td>With cert install</td>
<td>Transparent proxy. Catches traffic that ignores proxy settings.</td>
</tr>
<tr>
<td>VPN-based (PCAPdroid, NetGuard)</td>
<td>No</td>
<td>Metadata only</td>
<td>Captures packet headers without root. No decryption.</td>
</tr>
<tr>
<td>tcpdump on device</td>
<td>Yes</td>
<td>No decryption</td>
<td>Raw packet capture. Useful for non-HTTP protocols.</td>
</tr>
<tr>
<td>Wireshark on host</td>
<td>No</td>
<td>No decryption</td>
<td>Capture on shared network. Requires ARP spoofing or network tap.</td>
</tr>
</tbody>
</table>
<h3 id="proxy-setup-mitmproxy">Proxy Setup: mitmproxy<a class="headerlink" href="#proxy-setup-mitmproxy" title="Permanent link">&para;</a></h3>
<p><strong>On an emulator (Android Studio AVD):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>emulator<span class="w"> </span>-avd<span class="w"> </span>Pixel_6_API_33<span class="w"> </span>-http-proxy<span class="w"> </span>http://127.0.0.1:8080
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>mitmproxy<span class="w"> </span>--listen-port<span class="w"> </span><span class="m">8080</span><span class="w"> </span>--set<span class="w"> </span><span class="nv">block_global</span><span class="o">=</span><span class="nb">false</span>
</code></pre></div>
<p>Export the CA certificate and push it to the emulator:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>cp<span class="w"> </span>~/.mitmproxy/mitmproxy-ca-cert.cer<span class="w"> </span>/tmp/mitmproxy-ca.der
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>adb<span class="w"> </span>push<span class="w"> </span>/tmp/mitmproxy-ca.der<span class="w"> </span>/sdcard/
</code></pre></div>
<p>Install via Settings &gt; Security &gt; Encryption &amp; credentials &gt; Install a certificate &gt; CA certificate. This installs to the user store, which is sufficient for apps targeting API &lt; 24 or apps without <code>network_security_config.xml</code> restrictions.</p>
<p><strong>On a physical device:</strong></p>
<p>Connect the device and analysis machine to the same Wi-Fi network. Find the host machine's local IP:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>ifconfig<span class="w"> </span>en0<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;inet &quot;</span>
</code></pre></div>
<p>On the device: Settings &gt; Wi-Fi &gt; long-press connected network &gt; Modify network &gt; Advanced &gt; Proxy &gt; Manual. Set proxy hostname to the host IP, port to 8080. Push and install the CA cert the same way as above.</p>
<p><strong>Transparent proxy (catches traffic that ignores proxy settings):</strong></p>
<p>Some malware ignores the system proxy and connects directly. Use iptables on a rooted device to redirect all traffic:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>adb<span class="w"> </span>shell<span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;iptables -t nat -A OUTPUT -p tcp --dport 80 -j DNAT --to-destination 192.168.1.100:8080&quot;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>adb<span class="w"> </span>shell<span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;iptables -t nat -A OUTPUT -p tcp --dport 443 -j DNAT --to-destination 192.168.1.100:8080&quot;</span>
</code></pre></div>
<p>Run mitmproxy in transparent mode:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>mitmproxy<span class="w"> </span>--mode<span class="w"> </span>transparent<span class="w"> </span>--listen-port<span class="w"> </span><span class="m">8080</span>
</code></pre></div>
<h3 id="proxy-setup-burp-suite">Proxy Setup: Burp Suite<a class="headerlink" href="#proxy-setup-burp-suite" title="Permanent link">&para;</a></h3>
<p><strong>Burp listener configuration:</strong></p>
<p>In Burp Suite, go to Proxy &gt; Options &gt; Proxy Listeners. Add a listener on all interfaces (bind address <code>0.0.0.0</code>) on port 8082. Enable "Support invisible proxying" for transparent mode.</p>
<p><strong>Export the Burp CA:</strong></p>
<p>Browse to <code>http://&lt;burp-host&gt;:8082</code> from the device and download <code>cacert.der</code>. Alternatively, export from Burp: Proxy &gt; Options &gt; Import / export CA certificate &gt; Certificate in DER format.</p>
<p><strong>On an emulator:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>adb<span class="w"> </span>push<span class="w"> </span>cacert.der<span class="w"> </span>/sdcard/
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>emulator<span class="w"> </span>-avd<span class="w"> </span>Pixel_6_API_33<span class="w"> </span>-http-proxy<span class="w"> </span>http://127.0.0.1:8082
</code></pre></div>
<p><strong>On a physical device:</strong></p>
<p>Set the device Wi-Fi proxy to the host IP on port 8082, then install the CA cert from storage.</p>
<h3 id="certificate-installation">Certificate Installation<a class="headerlink" href="#certificate-installation" title="Permanent link">&para;</a></h3>
<p>For HTTPS interception, the proxy's CA certificate must be trusted by the device. Android 7+ (API 24+) introduced a critical change: apps targeting API 24 or above no longer trust user-installed CA certificates by default. This means user store installation is insufficient for most modern apps and all malware analysis scenarios.</p>
<p><strong>User certificate store</strong> (limited utility -- only works for apps targeting API &lt; 24 or apps with explicit user cert trust):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>adb<span class="w"> </span>push<span class="w"> </span>proxy-ca.der<span class="w"> </span>/sdcard/
</code></pre></div>
<p>Install via Settings &gt; Security &gt; Install from storage.</p>
<p><strong>System certificate store</strong> (requires root, works for all apps):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-inform<span class="w"> </span>DER<span class="w"> </span>-in<span class="w"> </span>proxy-ca.der<span class="w"> </span>-out<span class="w"> </span>proxy-ca.pem
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nv">HASH</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>x509<span class="w"> </span>-inform<span class="w"> </span>PEM<span class="w"> </span>-subject_hash_old<span class="w"> </span>-in<span class="w"> </span>proxy-ca.pem<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-1<span class="k">)</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>mv<span class="w"> </span>proxy-ca.pem<span class="w"> </span><span class="si">${</span><span class="nv">HASH</span><span class="si">}</span>.0
</code></pre></div>
<p>On Android 10 and below, <code>/system</code> is writable after remount:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>adb<span class="w"> </span>root
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>adb<span class="w"> </span>remount
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>adb<span class="w"> </span>push<span class="w"> </span><span class="si">${</span><span class="nv">HASH</span><span class="si">}</span>.0<span class="w"> </span>/system/etc/security/cacerts/
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>adb<span class="w"> </span>shell<span class="w"> </span>chmod<span class="w"> </span><span class="m">644</span><span class="w"> </span>/system/etc/security/cacerts/<span class="si">${</span><span class="nv">HASH</span><span class="si">}</span>.0
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>adb<span class="w"> </span>reboot
</code></pre></div>
<p>On Android 11-13, the system partition is read-only. Mount a tmpfs overlay:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>adb<span class="w"> </span>shell<span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;mount -t tmpfs tmpfs /system/etc/security/cacerts&quot;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>adb<span class="w"> </span>shell<span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;cp /apex/com.android.conscrypt/cacerts/* /system/etc/security/cacerts/&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>adb<span class="w"> </span>push<span class="w"> </span><span class="si">${</span><span class="nv">HASH</span><span class="si">}</span>.0<span class="w"> </span>/tmp/
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>adb<span class="w"> </span>shell<span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;mv /tmp/</span><span class="si">${</span><span class="nv">HASH</span><span class="si">}</span><span class="s2">.0 /system/etc/security/cacerts/&quot;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>adb<span class="w"> </span>shell<span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;chmod 644 /system/etc/security/cacerts/*&quot;</span>
</code></pre></div>
<p>This tmpfs mount does not survive reboots. Re-run after each restart.</p>
<p>On Android 14+, system certs are read from the <code>com.android.conscrypt</code> APEX module, and the overlay trick no longer works. Use the Magisk module approach below.</p>
<p><strong>Magisk module for system cert installation (Android 11+, recommended):</strong></p>
<p>The <code>MagiskTrustUserCerts</code> module copies all user-installed CA certificates into the system store at boot. This is the most reliable method for rooted devices running Android 11+.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>adb<span class="w"> </span>push<span class="w"> </span>MagiskTrustUserCerts.zip<span class="w"> </span>/sdcard/
</code></pre></div>
<p>Install the module via the Magisk Manager app, then reboot. After reboot, any certificate installed in the user store appears in the system store. Install the proxy CA as a user cert first, then install the module.</p>
<p>For Android 14+ specifically, the module patches the APEX mount to inject certificates into the Conscrypt module's cert directory.</p>
<p><strong>Emulator shortcut (writable system image):</strong></p>
<p>Android Studio AVDs with Google APIs (not Google Play) have a writable system partition when launched with <code>-writable-system</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>emulator<span class="w"> </span>-avd<span class="w"> </span>Pixel_6_API_33<span class="w"> </span>-writable-system<span class="w"> </span>-http-proxy<span class="w"> </span>http://127.0.0.1:8080
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>adb<span class="w"> </span>root
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>adb<span class="w"> </span>remount
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>adb<span class="w"> </span>push<span class="w"> </span><span class="si">${</span><span class="nv">HASH</span><span class="si">}</span>.0<span class="w"> </span>/system/etc/security/cacerts/
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>adb<span class="w"> </span>shell<span class="w"> </span>chmod<span class="w"> </span><span class="m">644</span><span class="w"> </span>/system/etc/security/cacerts/<span class="si">${</span><span class="nv">HASH</span><span class="si">}</span>.0
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>adb<span class="w"> </span>reboot
</code></pre></div>
<p>This is the simplest path for emulator-based analysis. No Magisk required.</p>
<h3 id="ssl-pinning-bypass">SSL Pinning Bypass<a class="headerlink" href="#ssl-pinning-bypass" title="Permanent link">&para;</a></h3>
<p>Most banking trojans and their target apps implement SSL pinning. Bypass approaches ranked by reliability:</p>
<table>
<thead>
<tr>
<th>Approach</th>
<th>Tool</th>
<th>Scope</th>
</tr>
</thead>
<tbody>
<tr>
<td>Frida script</td>
<td><a href="../hooking/">See Hooking</a></td>
<td>Per-library bypass (OkHttp, HttpURLConnection, WebView)</td>
</tr>
<tr>
<td>Objection</td>
<td><code>android sslpinning disable</code></td>
<td>Automated, covers common libraries</td>
</tr>
<tr>
<td>Network security config patch</td>
<td><a href="../patching/">See Patching</a></td>
<td>Modify <code>res/xml/network_security_config.xml</code> to trust user certs</td>
</tr>
<tr>
<td>Frida + reFrida</td>
<td><a href="https://github.com/zahidaz/refrida">reFrida</a></td>
<td>Visual interceptor for pinning bypass with real-time traffic view</td>
</tr>
</tbody>
</table>
<p>For malware specifically, SSL pinning bypass is needed to observe C2 communication. Most malware uses simpler HTTP clients than legitimate apps, so a basic OkHttp or HttpURLConnection hook covers the majority.</p>
<h3 id="universal-ssl-pinning-bypass-with-frida">Universal SSL Pinning Bypass with Frida<a class="headerlink" href="#universal-ssl-pinning-bypass-with-frida" title="Permanent link">&para;</a></h3>
<p>The following Frida script bypasses the most common pinning implementations in a single attach. It hooks SSLContext, TrustManager, OkHttp CertificatePinner, and Conscrypt's TrustManagerImpl.</p>
<details class="example">
<summary>Universal SSL Pinning Bypass Script</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">X509TrustManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;javax.net.ssl.X509TrustManager&quot;</span><span class="p">);</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">SSLContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;javax.net.ssl.SSLContext&quot;</span><span class="p">);</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">TrustManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">registerClass</span><span class="p">({</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;com.bypass.TrustManager&quot;</span><span class="p">,</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">        </span><span class="kr">implements</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">X509TrustManager</span><span class="p">],</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">        </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">            </span><span class="nx">checkClientTrusted</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">chain</span><span class="p">,</span><span class="w"> </span><span class="nx">authType</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">            </span><span class="nx">checkServerTrusted</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">chain</span><span class="p">,</span><span class="w"> </span><span class="nx">authType</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">            </span><span class="nx">getAcceptedIssuers</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">            </span><span class="p">},</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">TrustManagers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">TrustManager</span><span class="p">.</span><span class="nx">$new</span><span class="p">()];</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">sslContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SSLContext</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">(</span><span class="s2">&quot;TLS&quot;</span><span class="p">);</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="nx">sslContext</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="nx">TrustManagers</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">    </span><span class="nx">SSLContext</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="w">        </span><span class="s2">&quot;[Ljavax.net.ssl.KeyManager;&quot;</span><span class="p">,</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">        </span><span class="s2">&quot;[Ljavax.net.ssl.TrustManager;&quot;</span><span class="p">,</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="w">        </span><span class="s2">&quot;java.security.SecureRandom&quot;</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="w">    </span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">km</span><span class="p">,</span><span class="w"> </span><span class="nx">tm</span><span class="p">,</span><span class="w"> </span><span class="nx">sr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">km</span><span class="p">,</span><span class="w"> </span><span class="nx">TrustManagers</span><span class="p">,</span><span class="w"> </span><span class="nx">sr</span><span class="p">);</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">CertificatePinner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;okhttp3.CertificatePinner&quot;</span><span class="p">);</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="w">        </span><span class="nx">CertificatePinner</span><span class="p">.</span><span class="nx">check</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="w">            </span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">,</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="w">            </span><span class="s2">&quot;java.util.List&quot;</span>
<a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="w">        </span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">hostname</span><span class="p">,</span><span class="w"> </span><span class="nx">peerCertificates</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="w">        </span><span class="nx">CertificatePinner</span><span class="p">.</span><span class="nx">check$okhttp</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span>
<a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="w">            </span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">,</span>
<a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="w">            </span><span class="s2">&quot;kotlin.jvm.functions.Function0&quot;</span>
<a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="w">        </span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">hostname</span><span class="p">,</span><span class="w"> </span><span class="nx">cleanedCertificates</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>
<a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">CertPinnerLegacy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;okhttp3.CertificatePinner&quot;</span><span class="p">);</span>
<a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a><span class="w">        </span><span class="nx">CertPinnerLegacy</span><span class="p">.</span><span class="nx">check</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span>
<a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="w">            </span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">,</span>
<a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a><span class="w">            </span><span class="s2">&quot;[Ljava.security.cert.Certificate;&quot;</span>
<a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a><span class="w">        </span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">hostname</span><span class="p">,</span><span class="w"> </span><span class="nx">peerCertificates</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a>
<a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-49" name="__codelineno-13-49" href="#__codelineno-13-49"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">TrustManagerImpl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<a id="__codelineno-13-50" name="__codelineno-13-50" href="#__codelineno-13-50"></a><span class="w">            </span><span class="s2">&quot;com.android.org.conscrypt.TrustManagerImpl&quot;</span>
<a id="__codelineno-13-51" name="__codelineno-13-51" href="#__codelineno-13-51"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-13-52" name="__codelineno-13-52" href="#__codelineno-13-52"></a><span class="w">        </span><span class="nx">TrustManagerImpl</span><span class="p">.</span><span class="nx">verifyChain</span><span class="p">.</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-13-53" name="__codelineno-13-53" href="#__codelineno-13-53"></a><span class="w">            </span><span class="nx">untrustedChain</span><span class="p">,</span>
<a id="__codelineno-13-54" name="__codelineno-13-54" href="#__codelineno-13-54"></a><span class="w">            </span><span class="nx">trustAnchorChain</span><span class="p">,</span>
<a id="__codelineno-13-55" name="__codelineno-13-55" href="#__codelineno-13-55"></a><span class="w">            </span><span class="nx">host</span><span class="p">,</span>
<a id="__codelineno-13-56" name="__codelineno-13-56" href="#__codelineno-13-56"></a><span class="w">            </span><span class="nx">clientAuth</span><span class="p">,</span>
<a id="__codelineno-13-57" name="__codelineno-13-57" href="#__codelineno-13-57"></a><span class="w">            </span><span class="nx">ocspData</span><span class="p">,</span>
<a id="__codelineno-13-58" name="__codelineno-13-58" href="#__codelineno-13-58"></a><span class="w">            </span><span class="nx">tlsSctData</span>
<a id="__codelineno-13-59" name="__codelineno-13-59" href="#__codelineno-13-59"></a><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-60" name="__codelineno-13-60" href="#__codelineno-13-60"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nx">untrustedChain</span><span class="p">;</span>
<a id="__codelineno-13-61" name="__codelineno-13-61" href="#__codelineno-13-61"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-13-62" name="__codelineno-13-62" href="#__codelineno-13-62"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-13-63" name="__codelineno-13-63" href="#__codelineno-13-63"></a>
<a id="__codelineno-13-64" name="__codelineno-13-64" href="#__codelineno-13-64"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-65" name="__codelineno-13-65" href="#__codelineno-13-65"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">PlatformImpl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<a id="__codelineno-13-66" name="__codelineno-13-66" href="#__codelineno-13-66"></a><span class="w">            </span><span class="s2">&quot;com.android.org.conscrypt.Platform&quot;</span>
<a id="__codelineno-13-67" name="__codelineno-13-67" href="#__codelineno-13-67"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-13-68" name="__codelineno-13-68" href="#__codelineno-13-68"></a><span class="w">        </span><span class="nx">PlatformImpl</span><span class="p">.</span><span class="nx">checkServerTrusted</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span>
<a id="__codelineno-13-69" name="__codelineno-13-69" href="#__codelineno-13-69"></a><span class="w">            </span><span class="s2">&quot;javax.net.ssl.X509TrustManager&quot;</span><span class="p">,</span>
<a id="__codelineno-13-70" name="__codelineno-13-70" href="#__codelineno-13-70"></a><span class="w">            </span><span class="s2">&quot;[Ljava.security.cert.X509Certificate;&quot;</span><span class="p">,</span>
<a id="__codelineno-13-71" name="__codelineno-13-71" href="#__codelineno-13-71"></a><span class="w">            </span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">,</span>
<a id="__codelineno-13-72" name="__codelineno-13-72" href="#__codelineno-13-72"></a><span class="w">            </span><span class="s2">&quot;com.android.org.conscrypt.AbstractConscryptSocket&quot;</span>
<a id="__codelineno-13-73" name="__codelineno-13-73" href="#__codelineno-13-73"></a><span class="w">        </span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">tm</span><span class="p">,</span><span class="w"> </span><span class="nx">chain</span><span class="p">,</span><span class="w"> </span><span class="nx">authType</span><span class="p">,</span><span class="w"> </span><span class="nx">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<a id="__codelineno-13-74" name="__codelineno-13-74" href="#__codelineno-13-74"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-13-75" name="__codelineno-13-75" href="#__codelineno-13-75"></a>
<a id="__codelineno-13-76" name="__codelineno-13-76" href="#__codelineno-13-76"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-77" name="__codelineno-13-77" href="#__codelineno-13-77"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">WebViewClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;android.webkit.WebViewClient&quot;</span><span class="p">);</span>
<a id="__codelineno-13-78" name="__codelineno-13-78" href="#__codelineno-13-78"></a><span class="w">        </span><span class="nx">WebViewClient</span><span class="p">.</span><span class="nx">onReceivedSslError</span><span class="p">.</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-13-79" name="__codelineno-13-79" href="#__codelineno-13-79"></a><span class="w">            </span><span class="nx">view</span><span class="p">,</span>
<a id="__codelineno-13-80" name="__codelineno-13-80" href="#__codelineno-13-80"></a><span class="w">            </span><span class="nx">handler</span><span class="p">,</span>
<a id="__codelineno-13-81" name="__codelineno-13-81" href="#__codelineno-13-81"></a><span class="w">            </span><span class="nx">error</span>
<a id="__codelineno-13-82" name="__codelineno-13-82" href="#__codelineno-13-82"></a><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-83" name="__codelineno-13-83" href="#__codelineno-13-83"></a><span class="w">            </span><span class="nx">handler</span><span class="p">.</span><span class="nx">proceed</span><span class="p">();</span>
<a id="__codelineno-13-84" name="__codelineno-13-84" href="#__codelineno-13-84"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-13-85" name="__codelineno-13-85" href="#__codelineno-13-85"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-13-86" name="__codelineno-13-86" href="#__codelineno-13-86"></a><span class="p">});</span>
</code></pre></div>
</details>
<p>Run with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>frida<span class="w"> </span>-U<span class="w"> </span>-l<span class="w"> </span>ssl_bypass.js<span class="w"> </span>-f<span class="w"> </span>com.target.package
</code></pre></div>
<h3 id="objection-ssl-pinning-disable">Objection SSL Pinning Disable<a class="headerlink" href="#objection-ssl-pinning-disable" title="Permanent link">&para;</a></h3>
<p>Objection provides a one-command bypass that hooks the same classes automatically:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>objection<span class="w"> </span>-g<span class="w"> </span>com.target.package<span class="w"> </span>explore
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>android sslpinning disable
</code></pre></div>
<p>This hooks <code>TrustManagerImpl</code>, <code>X509TrustManager</code>, <code>SSLContext</code>, <code>OkHttp3 CertificatePinner</code>, and <code>WebViewClient.onReceivedSslError</code>. For most malware samples, this is sufficient. If the sample uses native pinning or a non-standard library, fall back to the manual Frida script above or a framework-specific bypass.</p>
<h3 id="ssl-pinning-bypass-by-framework">SSL Pinning Bypass by Framework<a class="headerlink" href="#ssl-pinning-bypass-by-framework" title="Permanent link">&para;</a></h3>
<p>Different development frameworks implement SSL pinning at different layers. The universal Frida script above covers native Android apps, but cross-platform frameworks bundle their own TLS stacks and require framework-specific bypass strategies. See <a href="../frameworks/">Development Frameworks</a> for framework identification and reversing approaches.</p>
<table>
<thead>
<tr>
<th>Framework / Context</th>
<th>Pinning Mechanism</th>
<th>Bypass Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Default Android (NetworkSecurityConfig)</td>
<td>XML-declared CA restrictions and <code>&lt;pin-set&gt;</code></td>
<td>Patch <code>res/xml/network_security_config.xml</code> to add <code>&lt;certificates src="user" /&gt;</code>, or install proxy cert as system cert</td>
</tr>
<tr>
<td>OkHttp <code>CertificatePinner</code></td>
<td>Hash-based certificate chain pinning</td>
<td>Frida hook on <code>CertificatePinner.check()</code> and <code>check$okhttp()</code> to return without throwing</td>
</tr>
<tr>
<td>Retrofit + OkHttp</td>
<td>Delegates entirely to OkHttp's <code>CertificatePinner</code></td>
<td>Same as OkHttp -- Retrofit adds no pinning layer of its own</td>
</tr>
<tr>
<td>Flutter (BoringSSL)</td>
<td>Native BoringSSL in <code>libflutter.so</code>, bypasses Java cert store</td>
<td>Hook <code>ssl_crypto_x509_session_verify_cert_chain</code> in <code>libflutter.so</code> to force return <code>true</code></td>
</tr>
<tr>
<td>React Native</td>
<td>Depends on underlying HTTP client (OkHttp on Android)</td>
<td>Standard OkHttp hooks usually work. For <code>react-native-ssl-pinning</code>, hook the specific native method</td>
</tr>
<tr>
<td>WebView</td>
<td><code>WebViewClient.onReceivedSslError</code> callback</td>
<td>Hook <code>onReceivedSslError</code> to call <code>handler.proceed()</code> instead of <code>handler.cancel()</code></td>
</tr>
<tr>
<td>Certificate Transparency</td>
<td>Separate CT log verification after pinning</td>
<td>Requires its own bypass -- hook <code>CTLogVerifier</code> or CT policy class. Pinning bypass alone is insufficient</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Flutter and React Native</p>
<p>Flutter apps do not use Java HTTP clients at all. OkHttp/HttpURLConnection Frida hooks have zero effect. You must target the native BoringSSL layer inside <code>libflutter.so</code>. React Native apps typically delegate to OkHttp, so standard Java hooks work, but apps with custom native modules like <code>react-native-ssl-pinning</code> may need additional native-layer hooks.</p>
</div>
<details class="example">
<summary>Flutter BoringSSL Pinning Bypass (Frida)</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">flutterModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Process</span><span class="p">.</span><span class="nx">findModuleByName</span><span class="p">(</span><span class="s2">&quot;libflutter.so&quot;</span><span class="p">);</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">flutterModule</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">resolvedAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Module</span><span class="p">.</span><span class="nx">findExportByName</span><span class="p">(</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">        </span><span class="s2">&quot;libflutter.so&quot;</span><span class="p">,</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">        </span><span class="s2">&quot;ssl_crypto_x509_session_verify_cert_chain&quot;</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">resolvedAddress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;FF C3 08 00 00 14&quot;</span><span class="p">;</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Memory</span><span class="p">.</span><span class="nx">scanSync</span><span class="p">(</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">            </span><span class="nx">flutterModule</span><span class="p">.</span><span class="nx">base</span><span class="p">,</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="w">            </span><span class="nx">flutterModule</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="w">            </span><span class="nx">pattern</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="w">            </span><span class="nx">resolvedAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">matches</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">address</span><span class="p">;</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">resolvedAddress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="w">        </span><span class="nx">Interceptor</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nx">resolvedAddress</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="w">            </span><span class="nx">onLeave</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="w">                </span><span class="nx">retval</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="mh">0x1</span><span class="p">);</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="w">            </span><span class="p">},</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="w">        </span><span class="p">});</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="p">}</span>
</code></pre></div>
</details>
<p>For packed apps that encrypt the pinning implementation, unpack first using <code>frida-dexdump</code> or the appropriate unpacker before applying bypasses. See <a href="../../packers/">packers</a> for details.</p>
<h3 id="certificate-pinning-detection-indicators">Certificate Pinning Detection Indicators<a class="headerlink" href="#certificate-pinning-detection-indicators" title="Permanent link">&para;</a></h3>
<p>Before attempting a bypass, identify whether pinning is present and what type:</p>
<table>
<thead>
<tr>
<th>Indicator</th>
<th>What It Means</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CertificatePinner</code> in decompiled source</td>
<td>OkHttp pin-set pinning</td>
</tr>
<tr>
<td><code>network_security_config.xml</code> with <code>&lt;pin-set&gt;</code> elements</td>
<td>Android declarative pinning</td>
</tr>
<tr>
<td>Custom <code>X509TrustManager</code> implementation</td>
<td>Manual trust validation</td>
</tr>
<tr>
<td><code>libflutter.so</code> present in <code>lib/</code></td>
<td>Flutter BoringSSL pinning likely</td>
</tr>
<tr>
<td><code>SSL_CTX_set_verify</code> in native <code>.so</code> files</td>
<td>Native OpenSSL/BoringSSL pinning</td>
</tr>
<tr>
<td>Connection fails with <code>SSLHandshakeException</code> when proxied</td>
<td>Pinning is active</td>
</tr>
<tr>
<td>Connection fails with <code>CertPathValidatorException</code> when proxied</td>
<td>Cert not trusted (may be user store issue, not pinning)</td>
</tr>
<tr>
<td>Traffic goes to port 443 but nothing appears in proxy</td>
<td>App ignores system proxy -- use transparent proxy with iptables</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Quick Pinning Check</p>
<p>Run the app through the proxy without any bypass. If the app works normally, there is no pinning. If connections fail with SSL errors in logcat, pinning is active. Use <code>adb logcat | grep -i ssl</code> to see the specific error class, which tells you the pinning implementation.</p>
</div>
<h3 id="ssl-pinning-bypass-by-implementation">SSL Pinning Bypass by Implementation<a class="headerlink" href="#ssl-pinning-bypass-by-implementation" title="Permanent link">&para;</a></h3>
<p>Different pinning implementations require different bypass strategies. The table below maps each pinning method to its specific bypass.</p>
<table>
<thead>
<tr>
<th>Pinning Implementation</th>
<th>Where It Appears</th>
<th>Bypass Method</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>OkHttp <code>CertificatePinner</code></td>
<td>Most Java/Kotlin apps, majority of Android malware</td>
<td>Frida hook on <code>CertificatePinner.check</code></td>
<td>Hook the <code>check</code> overload to return without throwing. See Frida script below.</td>
</tr>
<tr>
<td>Custom <code>X509TrustManager</code></td>
<td>Apps implementing their own cert validation</td>
<td>Frida hook on <code>checkServerTrusted</code></td>
<td>Replace <code>checkServerTrusted</code> to return empty, bypassing the custom validation logic.</td>
</tr>
<tr>
<td><code>network_security_config.xml</code> with <code>&lt;pin-set&gt;</code></td>
<td>Apps using Android's built-in pinning declaration</td>
<td>Repackage APK with modified XML</td>
<td>Decompile with apktool, edit <code>res/xml/network_security_config.xml</code> to remove <code>&lt;pin-set&gt;</code> and add <code>&lt;trust-anchors&gt;</code> for user certs. Reassemble, sign, install.</td>
</tr>
<tr>
<td><code>network_security_config.xml</code> domain restrictions</td>
<td>Apps restricting cleartext or cert trust per domain</td>
<td>Repackage with permissive config</td>
<td>Replace the entire config with one that trusts user certs for all domains.</td>
</tr>
<tr>
<td>Native OpenSSL (<code>libssl.so</code>)</td>
<td>NDK apps making direct native TLS calls</td>
<td>Frida native hook on <code>SSL_CTX_set_verify</code></td>
<td>Hook <code>SSL_CTX_set_verify</code> in <code>libssl.so</code> and replace the callback with one that always succeeds.</td>
</tr>
<tr>
<td>BoringSSL in Flutter (<code>libflutter.so</code>)</td>
<td>All Flutter apps</td>
<td>Patch <code>libflutter.so</code> or use reFlutter</td>
<td>Flutter bundles BoringSSL and bypasses the Android cert store entirely. Use <a href="https://github.com/Impact-I/reFlutter">reFlutter</a> to patch the binary, or locate <code>ssl_crypto_x509_session_verify_cert_chain</code> with Ghidra and NOP it. See <a href="../frameworks/">frameworks</a> for details.</td>
</tr>
<tr>
<td>React Native TLS</td>
<td>React Native apps with native pinning modules</td>
<td>Java-layer Frida hook or patch JS bundle</td>
<td>If pinning is via <code>react-native-ssl-pinning</code>, hook OkHttp at the Java layer. If pinning is in the JS fetch wrapper, patch <code>assets/index.android.bundle</code>. See <a href="../frameworks/">frameworks</a>.</td>
</tr>
<tr>
<td>Conscrypt / <code>TrustManagerImpl</code></td>
<td>System default TLS via Conscrypt provider</td>
<td>Frida hook on <code>TrustManagerImpl.verifyChain</code></td>
<td>Hook <code>com.android.org.conscrypt.TrustManagerImpl</code> to bypass the platform-level chain validation.</td>
</tr>
<tr>
<td>Xamarin <code>ServicePointManager</code></td>
<td>Xamarin/.NET MAUI apps</td>
<td>Patch the assembly DLL or hook Mono runtime</td>
<td>Edit <code>ServerCertificateValidationCallback</code> in the DLL with dnSpy to always return true. See <a href="../frameworks/">frameworks</a>.</td>
</tr>
<tr>
<td>Packed apps with pinning</td>
<td>Samples protected by <a href="../../packers/">commercial packers</a></td>
<td>Unpack first, then apply standard bypass</td>
<td>Packers like DexGuard or Virbox may encrypt the pinning implementation. Use <code>frida-dexdump</code> to recover the DEX, then identify and bypass the pinning method.</td>
</tr>
</tbody>
</table>
<p><strong>Repackaging <code>network_security_config.xml</code>:</strong></p>
<p>Decompile, replace the config, reassemble:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>apktool<span class="w"> </span>d<span class="w"> </span>target.apk<span class="w"> </span>-o<span class="w"> </span>target_patched/
</code></pre></div>
<p>Write a permissive <code>res/xml/network_security_config.xml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="nt">&lt;network-security-config&gt;</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="nt">&lt;base-config</span><span class="w"> </span><span class="na">cleartextTrafficPermitted=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">        </span><span class="nt">&lt;trust-anchors&gt;</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">            </span><span class="nt">&lt;certificates</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;system&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">            </span><span class="nt">&lt;certificates</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;user&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">        </span><span class="nt">&lt;/trust-anchors&gt;</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">    </span><span class="nt">&lt;/base-config&gt;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="nt">&lt;/network-security-config&gt;</span>
</code></pre></div>
<p>If the app's <code>AndroidManifest.xml</code> does not reference this file, add the attribute:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nt">&lt;application</span><span class="w"> </span><span class="na">android:networkSecurityConfig=</span><span class="s">&quot;@xml/network_security_config&quot;</span><span class="w"> </span><span class="err">...</span><span class="nt">&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>apktool<span class="w"> </span>b<span class="w"> </span>target_patched/<span class="w"> </span>-o<span class="w"> </span>target_patched.apk
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>apksigner<span class="w"> </span>sign<span class="w"> </span>--ks<span class="w"> </span>debug.keystore<span class="w"> </span>target_patched.apk
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>adb<span class="w"> </span>install<span class="w"> </span>target_patched.apk
</code></pre></div>
<h2 id="c2-protocol-identification">C2 Protocol Identification<a class="headerlink" href="#c2-protocol-identification" title="Permanent link">&para;</a></h2>
<p>Android malware C2 protocols fall into distinct categories. Identifying the protocol type determines the analysis approach. For detailed C2 implementation patterns, see <a href="../../attacks/c2-techniques/">C2 Communication Techniques</a>.</p>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Indicators</th>
<th>Families</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTP/REST</td>
<td>Standard HTTP methods, JSON/XML payloads, URL path structure</td>
<td><a href="../../malware/families/cerberus/">Cerberus</a>, <a href="../../malware/families/anubis/">Anubis</a>, <a href="../../malware/families/godfather/">GodFather</a>, <a href="../../malware/families/rafelrat/">Rafel RAT</a></td>
</tr>
<tr>
<td>WebSocket</td>
<td><code>ws://</code> or <code>wss://</code> URLs, <code>Upgrade: websocket</code> header, persistent connection</td>
<td><a href="../../malware/families/tsarbot/">TsarBot</a>, <a href="../../malware/families/antidot/">Antidot</a>, <a href="../../malware/families/blankbot/">BlankBot</a>, <a href="../../malware/families/btmob/">BTMOB RAT</a>, <a href="../../malware/families/pjobrat/">PJobRAT</a></td>
</tr>
<tr>
<td>MQTT</td>
<td>Port 1883/8883, CONNECT/PUBLISH/SUBSCRIBE packets</td>
<td><a href="../../malware/families/copybara/">Copybara</a></td>
</tr>
<tr>
<td>Raw TCP</td>
<td>Custom binary protocol, non-standard ports</td>
<td><a href="../../malware/families/albiriox/">Albiriox</a> (unencrypted TCP), <a href="../../malware/families/spynote/">SpyNote</a></td>
</tr>
<tr>
<td>Firebase Cloud Messaging</td>
<td><code>fcm.googleapis.com</code>, JSON with <code>registration_ids</code></td>
<td><a href="../../malware/families/vultur/">Vultur</a> v2, <a href="../../malware/families/pjobrat/">PJobRAT</a>, <a href="../../malware/families/kospy/">KoSpy</a>, <a href="../../malware/families/firescam/">FireScam</a>, <a href="../../malware/families/devixor/">DeVixor</a></td>
</tr>
<tr>
<td>Firebase Firestore</td>
<td><code>firestore.googleapis.com</code>, document reads/writes</td>
<td><a href="../../malware/families/kospy/">KoSpy</a> (C2 config delivery)</td>
</tr>
<tr>
<td>Telegram Bot API</td>
<td><code>api.telegram.org/bot&lt;token&gt;/</code>, <code>sendMessage</code>/<code>getUpdates</code></td>
<td><a href="../../malware/families/rafelrat/">Rafel RAT</a>, <a href="../../malware/families/mamont/">Mamont</a>, <a href="../../malware/families/devixor/">DeVixor</a></td>
</tr>
<tr>
<td>TOR</td>
<td><code>.onion</code> domains, SOCKS proxy on port 9050</td>
<td><a href="../../malware/families/hydra/">Hydra</a></td>
</tr>
<tr>
<td>Dead drop resolvers</td>
<td>Pastebin, Telegram channels, X (Twitter) posts containing encoded C2 addresses</td>
<td><a href="../../malware/families/medusa/">Medusa</a> v2</td>
</tr>
</tbody>
</table>
<h3 id="identifying-the-protocol-from-captured-traffic">Identifying the Protocol from Captured Traffic<a class="headerlink" href="#identifying-the-protocol-from-captured-traffic" title="Permanent link">&para;</a></h3>
<p>When capturing traffic from an unknown sample, use these indicators to classify the C2 channel:</p>
<p><strong>HTTP REST patterns:</strong> Look for repeated POST requests to the same URL path (e.g., <code>/gate.php</code>, <code>/api/bot</code>, <code>/panel/</code>). Request bodies are typically JSON with fields like <code>bot_id</code>, <code>action</code>, <code>cmd</code>. Responses contain JSON with command instructions. Polling intervals are usually 30--120 seconds. The User-Agent header is often the default OkHttp string or a hardcoded fake browser UA.</p>
<p><strong>WebSocket upgrade:</strong> A single HTTP request with <code>Connection: Upgrade</code> and <code>Upgrade: websocket</code> headers, followed by a persistent TCP connection. Subsequent traffic is framed WebSocket data. Malware WebSocket traffic is bidirectional -- the server pushes commands without the bot polling. Look for periodic ping/pong frames to maintain the connection.</p>
<p><strong>MQTT identification:</strong> Connects to port 1883 (unencrypted) or 8883 (TLS). The first packet is an MQTT CONNECT with a client ID (often the bot ID). Subsequent packets are PUBLISH and SUBSCRIBE operations. Wireshark decodes MQTT natively. The topic structure often reveals the botnet organization (e.g., <code>bots/&lt;bot_id&gt;/commands</code>).</p>
<p><strong>Telegram Bot API:</strong> All requests go to <code>api.telegram.org</code>. URLs contain a bot token in the format <code>bot&lt;numeric_id&gt;:&lt;alphanumeric_key&gt;</code>. Common endpoints: <code>/sendMessage</code>, <code>/getUpdates</code>, <code>/sendDocument</code>, <code>/sendPhoto</code>. The chat ID in request bodies identifies the operator's Telegram account or group.</p>
<p><strong>Firebase:</strong> Connections to <code>firebaseio.com</code>, <code>fcm.googleapis.com</code>, or <code>firestore.googleapis.com</code>. FCM traffic uses JSON with <code>registration_ids</code> or topic subscriptions. Firestore traffic involves document read/write operations. The Firebase project ID in the hostname identifies the attacker's project.</p>
<p><strong>Custom TCP:</strong> Non-HTTP traffic on unusual ports. Often has a fixed-size header with a length prefix, command type byte, and binary payload. Use Wireshark's "Follow TCP Stream" to examine the raw bytes. Look for repeating structures that indicate a command protocol. <a href="../../malware/families/spynote/">SpyNote</a> uses a custom binary protocol on high ports.</p>
<h3 id="protocol-analysis-workflow">Protocol Analysis Workflow<a class="headerlink" href="#protocol-analysis-workflow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>1. Capture traffic (proxy or tcpdump)
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>2. Identify protocol type from port/headers
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>3. For HTTP: decode JSON payloads, map API endpoints
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>4. For WebSocket: capture frame-by-frame, decode message format
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>5. For custom protocols: identify packet structure (length prefix, command ID, payload)
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>6. Map command set: what commands does the C2 send, what does the bot respond
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>7. Extract IOCs: domains, IPs, paths, tokens, bot IDs
</code></pre></div>
<h2 id="common-c2-protocol-patterns">Common C2 Protocol Patterns<a class="headerlink" href="#common-c2-protocol-patterns" title="Permanent link">&para;</a></h2>
<p>Practical breakdown of what each C2 protocol looks like in a network capture, with specific indicators to search for. For implementation-level analysis with code samples and family-specific protocol details, see <a href="../../attacks/c2-techniques/">C2 Communication Techniques</a>.</p>
<h3 id="http-rest-polling">HTTP REST Polling<a class="headerlink" href="#http-rest-polling" title="Permanent link">&para;</a></h3>
<p>The most common C2 pattern across Android malware. The bot registers on first launch, then polls at a fixed interval for commands.</p>
<ul>
<li>Repeating POST requests to the same URL path at regular intervals (e.g., <code>/gate.php</code>, <code>/api/bot</code>, <code>/panel/gate</code>)</li>
<li>JSON request body with a <code>bot_id</code> or <code>device_id</code> as the primary device identifier</li>
<li>Consistent polling interval, typically 15--60 seconds, sometimes dynamically configurable via C2 response</li>
<li>First request (registration beacon) is larger than subsequent polls -- contains device info, installed apps, country code</li>
<li>Response body contains command IDs/strings when commands are queued, or empty/<code>{"cmd":"idle"}</code> when not</li>
</ul>
<h3 id="websocket-persistent-connections">WebSocket Persistent Connections<a class="headerlink" href="#websocket-persistent-connections" title="Permanent link">&para;</a></h3>
<p>Used by families that need real-time bidirectional control -- remote access, screen streaming, VNC-like functionality.</p>
<ul>
<li>HTTP <code>Upgrade: websocket</code> handshake followed by a persistent TCP connection</li>
<li>WebSocket frames containing JSON messages or binary screen data</li>
<li>Event-driven message types rather than request-response (e.g., <code>{"type":"screen_update","data":"..."}</code>)</li>
<li>No polling interval -- commands arrive on demand from the C2</li>
<li>Periodic ping/pong frames as keepalive</li>
</ul>
<h3 id="telegram-bot-api-traffic">Telegram Bot API Traffic<a class="headerlink" href="#telegram-bot-api-traffic" title="Permanent link">&para;</a></h3>
<p>Abuses Telegram's infrastructure as a free, takedown-resistant C2 channel.</p>
<ul>
<li>HTTPS requests to <code>api.telegram.org/bot&lt;TOKEN&gt;/</code></li>
<li>API methods in the URL path: <code>sendMessage</code>, <code>getUpdates</code>, <code>sendDocument</code>, <code>sendPhoto</code></li>
<li>Bot token visible in the URL (format: <code>123456789:ABCdefGHIjklMNOpqrsTUVwxyz</code>)</li>
<li><code>chat_id</code> parameter in request body identifies the operator's Telegram account</li>
<li>Exfiltrated data often sent as document attachments via <code>sendDocument</code></li>
</ul>
<h3 id="firebase-cloud-messaging-wake-ups">Firebase Cloud Messaging Wake-ups<a class="headerlink" href="#firebase-cloud-messaging-wake-ups" title="Permanent link">&para;</a></h3>
<p>FCM acts as a wake-up channel rather than the primary C2 transport. The push notification triggers the malware to connect to the actual C2 over HTTP or WebSocket.</p>
<ul>
<li>Persistent connection to <code>mtalk.google.com</code> (FCM backend)</li>
<li>FCM registration token exchange at startup (<code>fcmregistrations.googleapis.com</code>)</li>
<li>Push payload may contain the C2 URL, a command trigger, or a "wake up and poll" signal</li>
<li>Correlate FCM push timing with subsequent HTTP requests to find the actual C2 channel</li>
<li>Difficult to intercept at network layer -- hook <code>FirebaseMessagingService.onMessageReceived</code> with Frida instead</li>
</ul>
<h3 id="dns-tunneling-indicators">DNS Tunneling Indicators<a class="headerlink" href="#dns-tunneling-indicators" title="Permanent link">&para;</a></h3>
<p>Rare on Android but used by advanced families to bypass HTTP-layer monitoring entirely.</p>
<ul>
<li>Unusually long subdomain labels containing encoded data (e.g., <code>dGVzdGRhdGE.evil.com</code>)</li>
<li>High volume of TXT, CNAME, or NULL record lookups to a single domain</li>
<li>Subdomain strings with base32/base64-like character patterns</li>
<li>DNS response records containing encoded payloads rather than legitimate IP addresses</li>
<li>Query frequency far exceeding normal mobile DNS behavior</li>
</ul>
<h3 id="heartbeat-intervals-by-family-type">Heartbeat Intervals by Family Type<a class="headerlink" href="#heartbeat-intervals-by-family-type" title="Permanent link">&para;</a></h3>
<p>The polling interval is a useful fingerprint for identifying the malware category during traffic analysis:</p>
<table>
<thead>
<tr>
<th>Interval Range</th>
<th>Family Type</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td>Persistent connection (no polling)</td>
<td>WebSocket-based RATs: <a href="../../malware/families/hook/">Hook</a>, <a href="../../malware/families/medusa/">Medusa</a>, <a href="../../malware/families/octo/">Octo</a> v2</td>
<td>Real-time remote access requires instant command delivery</td>
</tr>
<tr>
<td>5--15 seconds</td>
<td>Active RATs: <a href="../../malware/families/spynote/">SpyNote</a>, <a href="../../malware/families/btmob/">BTMOB RAT</a></td>
<td>Interactive remote control with minimal latency</td>
</tr>
<tr>
<td>30--60 seconds</td>
<td>Banking trojans: <a href="../../malware/families/cerberus/">Cerberus</a>, <a href="../../malware/families/anubis/">Anubis</a>, <a href="../../malware/families/godfather/">GodFather</a></td>
<td>Balance between responsiveness and battery/network stealth</td>
</tr>
<tr>
<td>60--120 seconds</td>
<td>Overlay-focused trojans: <a href="../../malware/families/anatsa/">Anatsa</a>, <a href="../../malware/families/xenomorph/">Xenomorph</a></td>
<td>Only needs periodic check for new inject targets</td>
</tr>
<tr>
<td>5--30 minutes</td>
<td>Spyware, stalkerware: <a href="../../malware/families/lightspy/">LightSpy</a>, <a href="../../malware/families/kospy/">KoSpy</a></td>
<td>Long-term surveillance, minimize battery and detection</td>
</tr>
<tr>
<td>FCM-triggered (no fixed interval)</td>
<td>FCM-wakeup families: <a href="../../malware/families/ermac/">Ermac</a>, <a href="../../malware/families/vultur/">Vultur</a> v2</td>
<td>No polling -- FCM push wakes the bot on demand</td>
</tr>
</tbody>
</table>
<h3 id="command-types-visible-in-traffic">Command Types Visible in Traffic<a class="headerlink" href="#command-types-visible-in-traffic" title="Permanent link">&para;</a></h3>
<p>Common command categories and how they appear in captured network traffic:</p>
<table>
<thead>
<tr>
<th>Command Category</th>
<th>Traffic Pattern</th>
<th>Example Payload</th>
</tr>
</thead>
<tbody>
<tr>
<td>Overlay injection</td>
<td>C2 sends target app package names and inject page URLs</td>
<td><code>{"cmd": "inj_enable", "apps": ["com.bank.app"], "url": "https://..."}</code></td>
</tr>
<tr>
<td>SMS interception</td>
<td>Bot forwards intercepted SMS to C2 immediately</td>
<td><code>{"cmd": "sms_log", "from": "+1555...", "body": "Your OTP is 123456"}</code></td>
</tr>
<tr>
<td>App list request</td>
<td>C2 requests installed apps, bot responds with package list</td>
<td><code>{"cmd": "get_apps"}</code> response: <code>{"apps": ["com.whatsapp", ...]}</code></td>
</tr>
<tr>
<td>Screen capture</td>
<td>C2 requests screenshot, bot responds with Base64 image</td>
<td><code>{"cmd": "screenshot"}</code> response: <code>{"img": "iVBORw0KGgo..."}</code></td>
</tr>
<tr>
<td>Keylog upload</td>
<td>Bot sends accumulated keystrokes periodically</td>
<td><code>{"cmd": "keylog", "data": "username: john\npassword: hunter2"}</code></td>
</tr>
<tr>
<td>Contact exfiltration</td>
<td>C2 requests contacts, bot dumps full contact list</td>
<td><code>{"cmd": "get_contacts"}</code> response: <code>{"contacts": [{...}]}</code></td>
</tr>
<tr>
<td>USSD execution</td>
<td>C2 sends USSD code for the bot to dial</td>
<td><code>{"cmd": "ussd", "code": "*100#"}</code></td>
</tr>
<tr>
<td>Push notification</td>
<td>C2 sends notification for social engineering</td>
<td><code>{"cmd": "push", "title": "Bank Alert", "body": "..."}</code></td>
</tr>
<tr>
<td>App install/uninstall</td>
<td>C2 instructs bot to install APK from URL or remove app</td>
<td><code>{"cmd": "install_app", "url": "https://..."}</code></td>
</tr>
<tr>
<td>Self-destruct</td>
<td>C2 instructs bot to wipe itself</td>
<td><code>{"cmd": "kill_bot"}</code> or <code>{"cmd": "uninstall"}</code></td>
</tr>
</tbody>
</table>
<h3 id="exfiltration-upload-indicators">Exfiltration Upload Indicators<a class="headerlink" href="#exfiltration-upload-indicators" title="Permanent link">&para;</a></h3>
<p>Large data uploads stand out in traffic captures. Look for these patterns to identify exfiltration activity:</p>
<ul>
<li>Sudden spike in upload volume compared to small polling requests</li>
<li>Multipart form data with file attachments (screenshots, recordings)</li>
<li>SFTP connections to separate servers (<a href="../../malware/families/vultur/">Vultur</a> uses SFTP for screen recordings while maintaining HTTP C2)</li>
<li>Base64-encoded binary data in JSON payloads (inefficient but common)</li>
<li>Telegram <code>sendDocument</code> or <code>sendPhoto</code> API calls with file attachments</li>
<li>Repeated large POSTs to a <code>/upload</code> or <code>/data</code> endpoint distinct from the command polling endpoint</li>
<li>Chunked transfer encoding for large payloads that exceed typical JSON body sizes</li>
</ul>
<h3 id="bot-panel-url-fingerprints">Bot Panel URL Fingerprints<a class="headerlink" href="#bot-panel-url-fingerprints" title="Permanent link">&para;</a></h3>
<p>C2 panel endpoints often leak information about the malware family or the panel software:</p>
<table>
<thead>
<tr>
<th>URL Pattern</th>
<th>Family / Panel Indicator</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/gate.php</code></td>
<td><a href="../../malware/families/cerberus/">Cerberus</a> lineage, <a href="../../malware/families/anubis/">Anubis</a></td>
</tr>
<tr>
<td><code>/api/mirrors</code></td>
<td><a href="../../malware/families/anatsa/">Anatsa</a></td>
</tr>
<tr>
<td><code>/o/</code> or <code>/observer/</code></td>
<td><a href="../../malware/families/godfather/">GodFather</a></td>
</tr>
<tr>
<td><code>/connect</code> WebSocket upgrade</td>
<td><a href="../../malware/families/hook/">Hook</a>, <a href="../../malware/families/medusa/">Medusa</a></td>
</tr>
<tr>
<td>Non-standard high port (4000--9999)</td>
<td><a href="../../malware/families/spynote/">SpyNote</a>, raw TCP families</td>
</tr>
<tr>
<td>Firebase project in hostname</td>
<td><a href="../../malware/families/firescam/">FireScam</a>, <a href="../../malware/families/kospy/">KoSpy</a></td>
</tr>
<tr>
<td><code>/bot&lt;token&gt;/sendMessage</code></td>
<td>Telegram-based C2 (<a href="../../malware/families/rafelrat/">Rafel RAT</a>, <a href="../../malware/families/mamont/">Mamont</a>)</td>
</tr>
<tr>
<td><code>/api/v1/bot/</code> or <code>/api/v2/bot/</code></td>
<td>Modern panel frameworks (Hook v2, Octo v2)</td>
</tr>
<tr>
<td><code>gate.php</code> with <code>action=</code> parameter</td>
<td>Classic Anubis/Cerberus panel structure</td>
</tr>
<tr>
<td><code>/panel/injects/</code></td>
<td>Separate inject kit hosting server</td>
</tr>
</tbody>
</table>
<h2 id="domain-generation-algorithms-dga">Domain Generation Algorithms (DGA)<a class="headerlink" href="#domain-generation-algorithms-dga" title="Permanent link">&para;</a></h2>
<p>Some families generate C2 domains algorithmically to resist infrastructure takedown:</p>
<table>
<thead>
<tr>
<th>Family</th>
<th>DGA Type</th>
<th>Predictability</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../../malware/families/sharkbot/">SharkBot</a></td>
<td>Date-seeded domain generation</td>
<td>Predictable with algorithm and seed</td>
</tr>
<tr>
<td><a href="../../malware/families/octo/">Octo</a> v2</td>
<td>Dynamic key-based DGA</td>
<td>Requires key extraction</td>
</tr>
<tr>
<td><a href="../../malware/families/moqhao/">MoqHao</a></td>
<td>DNS hijacking (not DGA, but similar resilience)</td>
<td>Requires DNS monitoring</td>
</tr>
</tbody>
</table>
<p>To analyze a DGA: extract the algorithm from decompiled code, determine the seed (often date-based), and generate the domain list. This enables preemptive domain sinkholing.</p>
<h2 id="exfiltration-channel-analysis">Exfiltration Channel Analysis<a class="headerlink" href="#exfiltration-channel-analysis" title="Permanent link">&para;</a></h2>
<p>Different families exfiltrate stolen data through different channels:</p>
<table>
<thead>
<tr>
<th>Channel</th>
<th>What's Sent</th>
<th>Families</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTP POST to C2</td>
<td>Credentials, SMS, contacts, device info</td>
<td>Most banking trojans</td>
</tr>
<tr>
<td>SFTP</td>
<td>Files, documents, media</td>
<td><a href="../../malware/families/dchspy/">DCHSpy</a></td>
</tr>
<tr>
<td>Telegram Bot</td>
<td>Screenshots, keylog dumps, SMS</td>
<td><a href="../../malware/families/rafelrat/">Rafel RAT</a>, <a href="../../malware/families/mamont/">Mamont</a></td>
</tr>
<tr>
<td>Firebase Realtime Database</td>
<td>Real-time data streaming</td>
<td><a href="../../malware/families/firescam/">FireScam</a></td>
</tr>
<tr>
<td>WebSocket streaming</td>
<td>Live screen data, input events</td>
<td><a href="../../malware/families/vultur/">Vultur</a>, <a href="../../malware/families/btmob/">BTMOB RAT</a></td>
</tr>
<tr>
<td>AWS S3 (misconfigured)</td>
<td>Exfiltrated victim data</td>
<td>RedHook (exposed S3 bucket)</td>
</tr>
<tr>
<td>VNC/AlphaVNC</td>
<td>Screen streaming</td>
<td><a href="../../malware/families/vultur/">Vultur</a> v1, <a href="../../malware/families/bingomod/">BingoMod</a></td>
</tr>
<tr>
<td>MediaProjection stream</td>
<td>Screen recording/streaming</td>
<td><a href="../../malware/families/gigabud/">Gigabud</a>, <a href="../../malware/families/blankbot/">BlankBot</a>, <a href="../../malware/families/btmob/">BTMOB RAT</a></td>
</tr>
</tbody>
</table>
<h2 id="traffic-encryption">Traffic Encryption<a class="headerlink" href="#traffic-encryption" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Encryption</th>
<th>How to Decrypt</th>
<th>Families</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard HTTPS</td>
<td>Proxy with cert install + pinning bypass</td>
<td>Most families</td>
</tr>
<tr>
<td>Custom AES on top of HTTPS</td>
<td>Hook <code>Cipher.doFinal</code> to capture plaintext</td>
<td><a href="../../malware/families/cerberus/">Cerberus</a> lineage</td>
</tr>
<tr>
<td>Unencrypted HTTP/TCP</td>
<td>No decryption needed</td>
<td><a href="../../malware/families/albiriox/">Albiriox</a>, older families</td>
</tr>
<tr>
<td>Certificate pinning only</td>
<td>Bypass pinning, traffic is readable</td>
<td><a href="../../malware/families/anatsa/">Anatsa</a>, <a href="../../malware/families/xenomorph/">Xenomorph</a></td>
</tr>
<tr>
<td>TOR</td>
<td>Run malware through transparent TOR proxy, or hook before TOR encryption</td>
<td><a href="../../malware/families/hydra/">Hydra</a></td>
</tr>
<tr>
<td>Custom binary encoding</td>
<td>Reverse the encoding algorithm from decompiled code</td>
<td>Family-specific</td>
</tr>
</tbody>
</table>
<h3 id="hooking-javaxcryptocipher-for-plaintext-capture">Hooking javax.crypto.Cipher for Plaintext Capture<a class="headerlink" href="#hooking-javaxcryptocipher-for-plaintext-capture" title="Permanent link">&para;</a></h3>
<p>When malware applies its own encryption layer on top of HTTPS, the proxy sees encrypted blobs even after TLS termination. Hook <code>javax.crypto.Cipher</code> to capture data before encryption and after decryption.</p>
<details class="example">
<summary>Cipher.doFinal Hook Script</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;javax.crypto.Cipher&quot;</span><span class="p">);</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">ENCRYPT_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">DECRYPT_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="nx">Cipher</span><span class="p">.</span><span class="nx">doFinal</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;[B&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getOpmode</span><span class="p">();</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">algo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAlgorithm</span><span class="p">();</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">doFinal</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mode</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">ENCRYPT_MODE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">            </span><span class="nx">send</span><span class="p">({</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">                </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cipher&quot;</span><span class="p">,</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">                </span><span class="nx">direction</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;encrypt&quot;</span><span class="p">,</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">                </span><span class="nx">algorithm</span><span class="o">:</span><span class="w"> </span><span class="nx">algo</span><span class="p">,</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">                </span><span class="nx">plaintext</span><span class="o">:</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">input</span><span class="p">),</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">                </span><span class="nx">ciphertext</span><span class="o">:</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">            </span><span class="p">});</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mode</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">DECRYPT_MODE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">            </span><span class="nx">send</span><span class="p">({</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">                </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cipher&quot;</span><span class="p">,</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">                </span><span class="nx">direction</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;decrypt&quot;</span><span class="p">,</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">                </span><span class="nx">algorithm</span><span class="o">:</span><span class="w"> </span><span class="nx">algo</span><span class="p">,</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">                </span><span class="nx">ciphertext</span><span class="o">:</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">input</span><span class="p">),</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">                </span><span class="nx">plaintext</span><span class="o">:</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">            </span><span class="p">});</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="w">    </span><span class="nx">Cipher</span><span class="p">.</span><span class="nx">doFinal</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;[B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="w">        </span><span class="nx">input</span><span class="p">,</span>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="w">        </span><span class="nx">offset</span><span class="p">,</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="w">        </span><span class="nx">length</span>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getOpmode</span><span class="p">();</span>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">algo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAlgorithm</span><span class="p">();</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">offset</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">length</span><span class="p">);</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">doFinal</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="p">,</span><span class="w"> </span><span class="nx">length</span><span class="p">);</span>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a><span class="w">        </span><span class="nx">send</span><span class="p">({</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a><span class="w">            </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cipher&quot;</span><span class="p">,</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a><span class="w">            </span><span class="nx">direction</span><span class="o">:</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">ENCRYPT_MODE</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;encrypt&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;decrypt&quot;</span><span class="p">,</span>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a><span class="w">            </span><span class="nx">algorithm</span><span class="o">:</span><span class="w"> </span><span class="nx">algo</span><span class="p">,</span>
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a><span class="w">            </span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">slice</span><span class="p">),</span>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a><span class="w">            </span><span class="nx">output</span><span class="o">:</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span>
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="w">        </span><span class="p">});</span>
<a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a>
<a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a>
<a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a><span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">bytesToHex</span><span class="p">(</span><span class="nx">bytes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">hex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">bytes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a><span class="w">            </span><span class="nx">hex</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">bytes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">2</span><span class="p">));</span>
<a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">hex</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<a id="__codelineno-23-59" name="__codelineno-23-59" href="#__codelineno-23-59"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-23-60" name="__codelineno-23-60" href="#__codelineno-23-60"></a><span class="p">});</span>
</code></pre></div>
</details>
<p>To see the plaintext as readable strings instead of hex, add a UTF-8 decode:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;javax.crypto.Cipher&quot;</span><span class="p">);</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">StringClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">);</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">    </span><span class="nx">Cipher</span><span class="p">.</span><span class="nx">doFinal</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;[B&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">doFinal</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getOpmode</span><span class="p">();</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mode</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;[ENCRYPT] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">StringClass</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="nx">input</span><span class="p">));</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;[DECRYPT] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">StringClass</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="nx">result</span><span class="p">));</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="p">});</span>
</code></pre></div>
<h3 id="hooking-okhttp-interceptors-for-requestresponse-logging">Hooking OkHttp Interceptors for Request/Response Logging<a class="headerlink" href="#hooking-okhttp-interceptors-for-requestresponse-logging" title="Permanent link">&para;</a></h3>
<p>For malware that uses OkHttp (the majority of Android banking trojans), hook the interceptor chain to capture fully formed HTTP requests and responses before any application-layer encryption is applied.</p>
<details class="example">
<summary>OkHttp Request/Response Logger</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">OkHttpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;okhttp3.OkHttpClient&quot;</span><span class="p">);</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">Interceptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;okhttp3.Interceptor&quot;</span><span class="p">);</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">Buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;okio.Buffer&quot;</span><span class="p">);</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">LogInterceptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">registerClass</span><span class="p">({</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;com.bypass.LogInterceptor&quot;</span><span class="p">,</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">        </span><span class="kr">implements</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">Interceptor</span><span class="p">],</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">        </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">            </span><span class="nx">intercept</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">chain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">chain</span><span class="p">.</span><span class="nx">request</span><span class="p">();</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span><span class="p">();</span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">requestBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">()</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">$new</span><span class="p">();</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">                    </span><span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">().</span><span class="nx">writeTo</span><span class="p">(</span><span class="nx">buf</span><span class="p">);</span>
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">                    </span><span class="nx">requestBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">buf</span><span class="p">.</span><span class="nx">readUtf8</span><span class="p">();</span>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">method</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Headers: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">headers</span><span class="p">);</span>
<a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">requestBody</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">                    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Body: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">requestBody</span><span class="p">);</span>
<a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>
<a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">chain</span><span class="p">.</span><span class="nx">proceed</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
<a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">responseBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">peekBody</span><span class="p">(</span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.lang.Long&quot;</span><span class="p">).</span><span class="nx">MAX_VALUE</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">responseString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">responseBody</span><span class="p">.</span><span class="nx">string</span><span class="p">();</span>
<a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a>
<a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;&lt; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">code</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Response: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">responseString</span><span class="p">);</span>
<a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a>
<a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">;</span>
<a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="w">            </span><span class="p">},</span>
<a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a>
<a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a><span class="w">    </span><span class="nx">OkHttpClient</span><span class="p">.</span><span class="nx">$init</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;okhttp3.OkHttpClient$Builder&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a><span class="w">        </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a><span class="w">            </span><span class="nx">builder</span><span class="p">.</span><span class="nx">addInterceptor</span><span class="p">(</span><span class="nx">LogInterceptor</span><span class="p">.</span><span class="nx">$new</span><span class="p">());</span>
<a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">$init</span><span class="p">(</span><span class="nx">builder</span><span class="p">);</span>
<a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a><span class="p">});</span>
</code></pre></div>
</details>
<h3 id="custom-protocol-key-extraction">Custom Protocol Key Extraction<a class="headerlink" href="#custom-protocol-key-extraction" title="Permanent link">&para;</a></h3>
<p>When malware uses a custom encryption scheme, the decryption key must be extracted at runtime. Common patterns:</p>
<p><strong>Hardcoded key in code:</strong> Search decompiled source for <code>SecretKeySpec</code> construction. The byte array argument is the key.</p>
<p><strong>Key derived from device info:</strong> Hook the key derivation function to capture the generated key:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">SecretKeySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;javax.crypto.spec.SecretKeySpec&quot;</span><span class="p">);</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="nx">SecretKeySpec</span><span class="p">.</span><span class="nx">$init</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;[B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">        </span><span class="nx">keyBytes</span><span class="p">,</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">        </span><span class="nx">algorithm</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">keyBytes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">            </span><span class="nx">key</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">keyBytes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">2</span><span class="p">);</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;[KEY] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">algorithm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">key</span><span class="p">);</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">$init</span><span class="p">(</span><span class="nx">keyBytes</span><span class="p">,</span><span class="w"> </span><span class="nx">algorithm</span><span class="p">);</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="p">});</span>
</code></pre></div>
<p><strong>IV extraction:</strong> Hook <code>IvParameterSpec</code> to capture the initialization vector alongside the key:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">IvParameterSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;javax.crypto.spec.IvParameterSpec&quot;</span><span class="p">);</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">    </span><span class="nx">IvParameterSpec</span><span class="p">.</span><span class="nx">$init</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;[B&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">iv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">hex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">iv</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">            </span><span class="nx">hex</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">iv</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">2</span><span class="p">);</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;[IV] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">hex</span><span class="p">);</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">$init</span><span class="p">(</span><span class="nx">iv</span><span class="p">);</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="p">});</span>
</code></pre></div>
<p><strong>Key fetched from C2 server:</strong> Hook the network layer to capture the key exchange, then hook <code>SecretKeySpec</code> to confirm the derived key.</p>
<p><strong>Base64 + XOR encoding:</strong> Simpler families XOR the payload with a static key, then Base64-encode. Hook the encoding/decoding function directly, or extract the XOR key from the decompiled source and decode captured traffic in the proxy.</p>
<p><strong>Custom binary serialization:</strong> Some families use Protobuf, MessagePack, or custom binary formats instead of JSON. Hook the serialization/deserialization methods. For Protobuf, extract the <code>.proto</code> definitions from the decompiled code or reverse them from the wire format using <code>protoc --decode_raw</code>.</p>
<p><strong>Hooking at the network layer boundary:</strong> Instead of hooking crypto APIs (which capture all crypto operations including non-network ones), hook the app's own network methods. Find the class that builds HTTP requests (typically a class wrapping OkHttp or HttpURLConnection) and hook its send/receive methods to capture plaintext before the app's encryption layer. This is often cleaner because you get structured C2 data rather than raw bytes from every <code>Cipher.doFinal</code> call.</p>
<div class="admonition tip">
<p class="admonition-title">Combining Hooks</p>
<p>Run the Cipher hook, SecretKeySpec hook, and IvParameterSpec hook together to capture the key, IV, and encrypted/decrypted data simultaneously. This gives you everything needed to write a standalone decryptor for offline analysis of PCAP captures.</p>
</div>
<h2 id="frida-scripts-for-network-interception">Frida Scripts for Network Interception<a class="headerlink" href="#frida-scripts-for-network-interception" title="Permanent link">&para;</a></h2>
<p>For general Frida setup and fundamentals, see <a href="../hooking/">Hooking</a>. The scripts below cover network-layer hooks beyond the OkHttp interceptor above. These target alternative HTTP clients, WebSocket C2, native TLS, DNS resolution, and Telegram-based C2.</p>
<h3 id="httpurlconnection-hook">HttpURLConnection Hook<a class="headerlink" href="#httpurlconnection-hook" title="Permanent link">&para;</a></h3>
<p>Older malware and some families prefer <code>java.net.HttpURLConnection</code> over OkHttp. Hook the connection lifecycle to capture URLs, request methods, and response codes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.net.URL&quot;</span><span class="p">);</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">    </span><span class="nx">URL</span><span class="p">.</span><span class="nx">openConnection</span><span class="p">.</span><span class="nx">overload</span><span class="p">().</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">openConnection</span><span class="p">();</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[URL] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">conn</span><span class="p">;</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">HttpURLConnection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.net.HttpURLConnection&quot;</span><span class="p">);</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="w">    </span><span class="nx">HttpURLConnection</span><span class="p">.</span><span class="nx">getInputStream</span><span class="p">.</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getInputStream</span><span class="p">();</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[RESP] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getURL</span><span class="p">().</span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; code=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getResponseCode</span><span class="p">());</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">is</span><span class="p">;</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="w">    </span><span class="nx">HttpURLConnection</span><span class="p">.</span><span class="nx">getOutputStream</span><span class="p">.</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[REQ OUT] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getURL</span><span class="p">().</span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; method=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getRequestMethod</span><span class="p">());</span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getOutputStream</span><span class="p">();</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="p">});</span>
</code></pre></div>
<p>To capture the actual request body written to the OutputStream, hook <code>OutputStream.write</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">OutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.io.OutputStream&quot;</span><span class="p">);</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">    </span><span class="nx">OutputStream</span><span class="p">.</span><span class="nx">write</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;[B&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">bytes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">            </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[WRITE] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">).</span><span class="nx">$new</span><span class="p">(</span><span class="nx">bytes</span><span class="p">));</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">bytes</span><span class="p">);</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="p">});</span>
</code></pre></div>
<h3 id="websocket-interception">WebSocket Interception<a class="headerlink" href="#websocket-interception" title="Permanent link">&para;</a></h3>
<p>For families using WebSocket C2 (<a href="../../malware/families/hook/">Hook</a>, <a href="../../malware/families/medusa/">Medusa</a>, <a href="../../malware/families/octo/">Octo</a> v2, <a href="../../malware/families/tsarbot/">TsarBot</a>), hook both outgoing messages and incoming commands to capture the full bidirectional command stream:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">RealWebSocket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;okhttp3.internal.ws.RealWebSocket&quot;</span><span class="p">);</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">    </span><span class="nx">RealWebSocket</span><span class="p">.</span><span class="nx">send</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[WS SEND] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">text</span><span class="p">);</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">    </span><span class="nx">RealWebSocket</span><span class="p">.</span><span class="nx">send</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;okio.ByteString&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">bytes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[WS SEND BIN] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">bytes</span><span class="p">.</span><span class="nx">hex</span><span class="p">());</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">bytes</span><span class="p">);</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="w">    </span><span class="nx">Java</span><span class="p">.</span><span class="nx">enumerateLoadedClasses</span><span class="p">({</span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w">        </span><span class="nx">onMatch</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">className</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nx">cls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">className</span><span class="p">);</span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">cls</span><span class="p">.</span><span class="kd">class</span><span class="p">.</span><span class="nx">getSuperclass</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="w">                    </span><span class="nx">cls</span><span class="p">.</span><span class="kd">class</span><span class="p">.</span><span class="nx">getSuperclass</span><span class="p">().</span><span class="nx">getName</span><span class="p">()</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;okhttp3.WebSocketListener&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="w">                    </span><span class="nx">cls</span><span class="p">.</span><span class="nx">onMessage</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;okhttp3.WebSocket&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">ws</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="w">                        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[WS RECV] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">text</span><span class="p">);</span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="w">                        </span><span class="k">this</span><span class="p">.</span><span class="nx">onMessage</span><span class="p">(</span><span class="nx">ws</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">);</span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="w">                    </span><span class="p">};</span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="w">        </span><span class="nx">onComplete</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="p">});</span>
</code></pre></div>
<h3 id="native-ssl_write-ssl_read-hook">Native SSL_write / SSL_read Hook<a class="headerlink" href="#native-ssl_write-ssl_read-hook" title="Permanent link">&para;</a></h3>
<p>For malware using native TLS (NDK-based HTTP clients, custom native networking), Java-layer hooks produce nothing. Hook the OpenSSL/BoringSSL functions directly in the native layer to capture all TLS plaintext regardless of the Java HTTP client used:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">SSL_write</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Module</span><span class="p">.</span><span class="nx">findExportByName</span><span class="p">(</span><span class="s2">&quot;libssl.so&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;SSL_write&quot;</span><span class="p">);</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">SSL_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Module</span><span class="p">.</span><span class="nx">findExportByName</span><span class="p">(</span><span class="s2">&quot;libssl.so&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;SSL_read&quot;</span><span class="p">);</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">SSL_write</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">    </span><span class="nx">Interceptor</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nx">SSL_write</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">        </span><span class="nx">onEnter</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">[</span><span class="mf">2</span><span class="p">].</span><span class="nx">toInt32</span><span class="p">();</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">        </span><span class="nx">onLeave</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">retval</span><span class="p">.</span><span class="nx">toInt32</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">                </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[SSL_write] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">Memory</span><span class="p">.</span><span class="nx">readUtf8String</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">len</span><span class="p">));</span>
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="p">}</span>
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">SSL_read</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a><span class="w">    </span><span class="nx">Interceptor</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nx">SSL_read</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a><span class="w">        </span><span class="nx">onEnter</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">args</span><span class="p">[</span><span class="mf">2</span><span class="p">].</span><span class="nx">toInt32</span><span class="p">();</span>
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a><span class="w">        </span><span class="nx">onLeave</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">bytesRead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">retval</span><span class="p">.</span><span class="nx">toInt32</span><span class="p">();</span>
<a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">bytesRead</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a><span class="w">                </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[SSL_read] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">Memory</span><span class="p">.</span><span class="nx">readUtf8String</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">buf</span><span class="p">,</span><span class="w"> </span><span class="nx">bytesRead</span><span class="p">));</span>
<a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a><span class="p">}</span>
</code></pre></div>
<p>For Flutter apps that bundle BoringSSL inside <code>libflutter.so</code>, replace <code>libssl.so</code> with <code>libflutter.so</code> in the export lookup. The function names are the same. See <a href="../frameworks/">Development Frameworks</a> for Flutter-specific analysis.</p>
<h3 id="dns-resolution-hook">DNS Resolution Hook<a class="headerlink" href="#dns-resolution-hook" title="Permanent link">&para;</a></h3>
<p>Capture all domain resolutions to identify C2 domains, DGA output, and dead drop resolver lookups:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">InetAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.net.InetAddress&quot;</span><span class="p">);</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w">    </span><span class="nx">InetAddress</span><span class="p">.</span><span class="nx">getByName</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">host</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getByName</span><span class="p">(</span><span class="nx">host</span><span class="p">);</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[DNS] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; -&gt; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">getHostAddress</span><span class="p">());</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="w">    </span><span class="nx">InetAddress</span><span class="p">.</span><span class="nx">getAllByName</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="s2">&quot;java.lang.String&quot;</span><span class="p">).</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">host</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAllByName</span><span class="p">(</span><span class="nx">host</span><span class="p">);</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">ips</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="w">            </span><span class="nx">ips</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getHostAddress</span><span class="p">());</span>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w">        </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[DNS ALL] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; -&gt; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ips</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">));</span>
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">results</span><span class="p">;</span>
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="p">});</span>
</code></pre></div>
<h3 id="telegram-bot-api-interception">Telegram Bot API Interception<a class="headerlink" href="#telegram-bot-api-interception" title="Permanent link">&para;</a></h3>
<p>For families using Telegram as C2 (<a href="../../malware/families/rafelrat/">Rafel RAT</a>, <a href="../../malware/families/mamont/">Mamont</a>), hook HTTP requests and filter for the Telegram API to extract bot tokens and chat IDs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;java.net.URL&quot;</span><span class="p">);</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="nx">URL</span><span class="p">.</span><span class="nx">openConnection</span><span class="p">.</span><span class="nx">overload</span><span class="p">().</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">urlStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">urlStr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;api.telegram.org&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">urlStr</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;bot&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="w">                    </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[TELEGRAM] Bot token: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">substring</span><span class="p">(</span><span class="mf">3</span><span class="p">));</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="w">            </span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;[TELEGRAM] &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">urlStr</span><span class="p">);</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">openConnection</span><span class="p">();</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a><span class="p">});</span>
</code></pre></div>
<h2 id="traffic-analysis-checklist">Traffic Analysis Checklist<a class="headerlink" href="#traffic-analysis-checklist" title="Permanent link">&para;</a></h2>
<p>Systematic checklist for analyzing captured C2 traffic after interception and decryption. Work through each phase to fully characterize the malware's network behavior.</p>
<h3 id="registration-beacon">Registration Beacon<a class="headerlink" href="#registration-beacon" title="Permanent link">&para;</a></h3>
<p>The first request after installation or first launch. Contains device fingerprinting data used by the C2 panel to identify and categorize the bot.</p>
<ul>
<li>[ ] Identify the registration endpoint URL path and HTTP method</li>
<li>[ ] Extract the bot ID generation logic (ANDROID_ID, IMEI, UUID, or composite hash)</li>
<li>[ ] Document all device info fields: model, OS version, language, country, carrier, screen resolution</li>
<li>[ ] Check for installed app list or targeted app list (drives which injection overlays the C2 serves)</li>
<li>[ ] Note the C2 response -- configuration block, initial command set, or just an acknowledgment</li>
<li>[ ] Determine whether registration repeats on every launch or only on first run</li>
</ul>
<h3 id="heartbeat-interval">Heartbeat Interval<a class="headerlink" href="#heartbeat-interval" title="Permanent link">&para;</a></h3>
<p>How the bot maintains contact between active command sessions.</p>
<ul>
<li>[ ] Measure the polling interval (capture at least 5--10 cycles to establish the pattern)</li>
<li>[ ] Determine if the interval is hardcoded in the APK or dynamically set by C2 response fields</li>
<li>[ ] Look for jitter or randomization in the interval (anti-detection measure)</li>
<li>[ ] Identify the keepalive transport: HTTP polling, WebSocket ping/pong, or FCM push</li>
<li>[ ] Test C2 unreachable behavior: retry logic, exponential backoff, fallback URLs, DGA activation</li>
<li>[ ] Check if the interval changes after receiving a command (some families poll faster during active operations)</li>
</ul>
<h3 id="command-format">Command Format<a class="headerlink" href="#command-format" title="Permanent link">&para;</a></h3>
<p>The structure and encoding of commands from the C2 to the bot.</p>
<ul>
<li>[ ] Map the full command set -- capture as many distinct commands as possible</li>
<li>[ ] Determine command identifier format: numeric IDs, string names, or mixed</li>
<li>[ ] Document command parameters and expected bot response for each command type</li>
<li>[ ] Check for application-layer encryption or encoding on top of HTTPS (Base64, AES, XOR)</li>
<li>[ ] Identify targeted vs broadcast commands (bot ID filter, country filter, app-specific targeting)</li>
<li>[ ] Look for injection/overlay URL delivery as a distinct command type</li>
<li>[ ] Note the acknowledgment flow -- does the bot confirm command receipt and/or execution result?</li>
</ul>
<h3 id="exfiltration-patterns">Exfiltration Patterns<a class="headerlink" href="#exfiltration-patterns" title="Permanent link">&para;</a></h3>
<p>How and when stolen data leaves the device.</p>
<ul>
<li>[ ] Identify the exfiltration endpoint (same C2, separate data server, or third-party service like Telegram)</li>
<li>[ ] Document exfiltration triggers: on-demand via C2 command, automatic on credential capture, or periodic batch</li>
<li>[ ] Distinguish real-time streaming (WebSocket, screen share) from batched uploads (HTTP POST)</li>
<li>[ ] Check for file uploads (screenshots, recordings, documents) and note encoding and content type</li>
<li>[ ] Look for data compression or chunking for large payloads</li>
<li>[ ] Catalog exfiltrated data types: credentials, SMS, contacts, call logs, photos, keystrokes, accessibility events</li>
</ul>
<h2 id="mitmproxy-scripting">mitmproxy Scripting<a class="headerlink" href="#mitmproxy-scripting" title="Permanent link">&para;</a></h2>
<p><a href="https://mitmproxy.org/">mitmproxy</a> provides a Python addon API for programmatic traffic analysis. Writing addon scripts automates C2 payload decoding, Base64 body decryption, and bot ID extraction during dynamic analysis -- significantly more efficient than manually inspecting each flow.</p>
<h3 id="c2-traffic-decoder-addon">C2 Traffic Decoder Addon<a class="headerlink" href="#c2-traffic-decoder-addon" title="Permanent link">&para;</a></h3>
<p>This addon intercepts traffic to known C2 domains, attempts JSON parsing and Base64 decoding on request/response bodies, extracts bot IDs, and logs everything to structured JSONL files.</p>
<details class="example">
<summary>mitmproxy C2 Traffic Decoder</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mitmproxy</span><span class="w"> </span><span class="kn">import</span> <span class="n">http</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="n">C2_DOMAINS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;c2.example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;gate.malware.net&quot;</span><span class="p">]</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="n">BOT_ID_KEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bot_id&quot;</span><span class="p">,</span> <span class="s2">&quot;device_id&quot;</span><span class="p">,</span> <span class="s2">&quot;uid&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;botId&quot;</span><span class="p">,</span> <span class="s2">&quot;deviceId&quot;</span><span class="p">]</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">C2Decoder</span><span class="p">:</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seen_bot_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">HTTPFlow</span><span class="p">):</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">d</span> <span class="ow">in</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pretty_host</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">C2_DOMAINS</span><span class="p">):</span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>            <span class="k">return</span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>            <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;request&quot;</span><span class="p">,</span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pretty_url</span><span class="p">,</span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">timestamp_start</span><span class="p">,</span>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>        <span class="p">}</span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>        <span class="n">body</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>        <span class="k">if</span> <span class="n">body</span><span class="p">:</span>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a>            <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;body&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_decode</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_extract_bot_id</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;body&quot;</span><span class="p">])</span>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">HTTPFlow</span><span class="p">):</span>
<a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">d</span> <span class="ow">in</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pretty_host</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">C2_DOMAINS</span><span class="p">):</span>
<a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a>            <span class="k">return</span>
<a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>
<a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">flow</span><span class="o">.</span><span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">flow</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
<a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a>            <span class="k">return</span>
<a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a>
<a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a>            <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;response&quot;</span><span class="p">,</span>
<a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a>            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">pretty_url</span><span class="p">,</span>
<a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">flow</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
<a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a>            <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_decode</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">get_text</span><span class="p">()),</span>
<a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a>        <span class="p">}</span>
<a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a>
<a id="__codelineno-34-46" name="__codelineno-34-46" href="#__codelineno-34-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-34-47" name="__codelineno-34-47" href="#__codelineno-34-47"></a>
<a id="__codelineno-34-48" name="__codelineno-34-48" href="#__codelineno-34-48"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_try_decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-34-49" name="__codelineno-34-49" href="#__codelineno-34-49"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-34-50" name="__codelineno-34-50" href="#__codelineno-34-50"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-34-51" name="__codelineno-34-51" href="#__codelineno-34-51"></a>        <span class="k">except</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-34-52" name="__codelineno-34-52" href="#__codelineno-34-52"></a>            <span class="k">pass</span>
<a id="__codelineno-34-53" name="__codelineno-34-53" href="#__codelineno-34-53"></a>
<a id="__codelineno-34-54" name="__codelineno-34-54" href="#__codelineno-34-54"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-34-55" name="__codelineno-34-55" href="#__codelineno-34-55"></a>            <span class="n">decoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
<a id="__codelineno-34-56" name="__codelineno-34-56" href="#__codelineno-34-56"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-34-57" name="__codelineno-34-57" href="#__codelineno-34-57"></a>                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
<a id="__codelineno-34-58" name="__codelineno-34-58" href="#__codelineno-34-58"></a>            <span class="k">except</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-34-59" name="__codelineno-34-59" href="#__codelineno-34-59"></a>                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;base64_decoded&quot;</span><span class="p">:</span> <span class="n">decoded</span><span class="p">}</span>
<a id="__codelineno-34-60" name="__codelineno-34-60" href="#__codelineno-34-60"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-34-61" name="__codelineno-34-61" href="#__codelineno-34-61"></a>            <span class="k">pass</span>
<a id="__codelineno-34-62" name="__codelineno-34-62" href="#__codelineno-34-62"></a>
<a id="__codelineno-34-63" name="__codelineno-34-63" href="#__codelineno-34-63"></a>        <span class="k">return</span> <span class="n">data</span>
<a id="__codelineno-34-64" name="__codelineno-34-64" href="#__codelineno-34-64"></a>
<a id="__codelineno-34-65" name="__codelineno-34-65" href="#__codelineno-34-65"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_bot_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<a id="__codelineno-34-66" name="__codelineno-34-66" href="#__codelineno-34-66"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-34-67" name="__codelineno-34-67" href="#__codelineno-34-67"></a>            <span class="k">return</span>
<a id="__codelineno-34-68" name="__codelineno-34-68" href="#__codelineno-34-68"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">BOT_ID_KEYS</span><span class="p">:</span>
<a id="__codelineno-34-69" name="__codelineno-34-69" href="#__codelineno-34-69"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">body</span> <span class="ow">and</span> <span class="n">body</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seen_bot_ids</span><span class="p">:</span>
<a id="__codelineno-34-70" name="__codelineno-34-70" href="#__codelineno-34-70"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">seen_bot_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">body</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<a id="__codelineno-34-71" name="__codelineno-34-71" href="#__codelineno-34-71"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/c2_bot_ids.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-34-72" name="__codelineno-34-72" href="#__codelineno-34-72"></a>                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">body</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-34-73" name="__codelineno-34-73" href="#__codelineno-34-73"></a>
<a id="__codelineno-34-74" name="__codelineno-34-74" href="#__codelineno-34-74"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<a id="__codelineno-34-75" name="__codelineno-34-75" href="#__codelineno-34-75"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/c2_traffic.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-34-76" name="__codelineno-34-76" href="#__codelineno-34-76"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-34-77" name="__codelineno-34-77" href="#__codelineno-34-77"></a>
<a id="__codelineno-34-78" name="__codelineno-34-78" href="#__codelineno-34-78"></a>
<a id="__codelineno-34-79" name="__codelineno-34-79" href="#__codelineno-34-79"></a><span class="n">addons</span> <span class="o">=</span> <span class="p">[</span><span class="n">C2Decoder</span><span class="p">()]</span>
</code></pre></div>
</details>
<p>Set <code>C2_DOMAINS</code> to the malware's C2 infrastructure, then run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>mitmdump<span class="w"> </span>-s<span class="w"> </span>c2_decoder.py<span class="w"> </span>--set<span class="w"> </span><span class="nv">block_global</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>
</code></pre></div>
<p>After the analysis session, review captured data:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>cat<span class="w"> </span>/tmp/c2_traffic.jsonl<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool<span class="w"> </span>--no-ensure-ascii
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>sort<span class="w"> </span>-u<span class="w"> </span>/tmp/c2_bot_ids.txt
</code></pre></div>
<p>For live interactive analysis with simultaneous logging:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>mitmproxy<span class="w"> </span>-s<span class="w"> </span>c2_decoder.py<span class="w"> </span>--set<span class="w"> </span><span class="nv">block_global</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>
</code></pre></div>
<p>The addon logs decoded C2 traffic (JSON-parsed or Base64-decoded) to <code>/tmp/c2_traffic.jsonl</code> and extracted bot IDs to <code>/tmp/c2_bot_ids.txt</code>, while the TUI lets you inspect individual flows in real time.</p>
<h2 id="ioc-extraction-from-network-traffic">IOC Extraction from Network Traffic<a class="headerlink" href="#ioc-extraction-from-network-traffic" title="Permanent link">&para;</a></h2>
<p>After capturing and decrypting C2 traffic, extract indicators of compromise (IOCs) systematically. These IOCs feed into detection rules, threat intelligence platforms, and infrastructure tracking.</p>
<h3 id="what-to-extract">What to Extract<a class="headerlink" href="#what-to-extract" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>IOC Type</th>
<th>Where to Find It</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>C2 domains</td>
<td>DNS queries, HTTP Host header, URL paths</td>
<td><code>evil-panel.com</code>, <code>api.malware-c2.xyz</code></td>
</tr>
<tr>
<td>C2 IP addresses</td>
<td>DNS resolution, direct IP connections</td>
<td><code>185.215.113.x</code>, <code>91.92.240.x</code></td>
</tr>
<tr>
<td>URL paths</td>
<td>HTTP request URIs</td>
<td><code>/gate.php</code>, <code>/api/v2/bot</code>, <code>/panel/injects</code></td>
</tr>
<tr>
<td>Bot registration format</td>
<td>First POST request after install</td>
<td><code>{"bot_id": "...", "tag": "...", "country": "..."}</code></td>
</tr>
<tr>
<td>Bot ID generation</td>
<td>Registration payload, User-Agent, or URL param</td>
<td>IMEI, Android ID, or random UUID</td>
</tr>
<tr>
<td>Command polling interval</td>
<td>Time between repeated GET/POST requests</td>
<td>30s, 60s, 120s between identical requests</td>
</tr>
<tr>
<td>Command format</td>
<td>C2 response bodies</td>
<td><code>{"command": "sms_intercept", "params": {...}}</code></td>
</tr>
<tr>
<td>Exfiltration data format</td>
<td>POST bodies containing stolen data</td>
<td>JSON with SMS content, contacts, credentials</td>
</tr>
<tr>
<td>Inject kit download URLs</td>
<td>Responses containing overlay/phishing page URLs</td>
<td><code>https://cdn.evil.com/injects/com.bank.app.html</code></td>
</tr>
<tr>
<td>Telegram bot tokens</td>
<td>URLs to <code>api.telegram.org</code></td>
<td><code>bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11</code></td>
</tr>
<tr>
<td>Firebase project IDs</td>
<td>Hostnames in Firebase API calls</td>
<td><code>malware-project-12345.firebaseio.com</code></td>
</tr>
<tr>
<td>Encryption keys</td>
<td><code>SecretKeySpec</code> hook output, hardcoded strings</td>
<td>AES keys, XOR keys, RC4 keys</td>
</tr>
<tr>
<td>User-Agent strings</td>
<td>HTTP request headers</td>
<td>Custom or default OkHttp UA</td>
</tr>
<tr>
<td>TLS certificate fingerprints</td>
<td>Pinned certificates in the APK or observed in traffic</td>
<td>SHA-256 hash of the C2 server certificate</td>
</tr>
</tbody>
</table>
<h3 id="bot-registration-analysis">Bot Registration Analysis<a class="headerlink" href="#bot-registration-analysis" title="Permanent link">&para;</a></h3>
<p>The first network request after installation typically registers the bot with the C2 panel. This registration request reveals the botnet's organization:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="p">{</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="w">    </span><span class="nt">&quot;bot_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a1b2c3d4e5f6&quot;</span><span class="p">,</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;campaign_2024_q1&quot;</span><span class="p">,</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">    </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;US&quot;</span><span class="p">,</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">    </span><span class="nt">&quot;operator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="w">    </span><span class="nt">&quot;model&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pixel 6&quot;</span><span class="p">,</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="w">    </span><span class="nt">&quot;android_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;13&quot;</span><span class="p">,</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">    </span><span class="nt">&quot;app_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;com.bank.app1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;com.bank.app2&quot;</span><span class="p">],</span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="w">    </span><span class="nt">&quot;permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;accessibility&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sms&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;overlay&quot;</span><span class="p">]</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="p">}</span>
</code></pre></div>
<p>Key fields to note:</p>
<ul>
<li><strong>bot_id</strong> -- how the operator tracks individual victims. Often derived from Android ID, IMEI, or a random UUID stored in SharedPreferences.</li>
<li><strong>tag</strong> -- campaign identifier. Links this sample to a specific distribution campaign.</li>
<li><strong>app_list</strong> -- list of installed apps sent to the C2 so it knows which inject overlays to serve. Reveals the target list.</li>
<li><strong>permissions</strong> -- tells the C2 what capabilities the bot has, which determines what commands it can receive.</li>
</ul>
<h3 id="command-polling-pattern-identification">Command Polling Pattern Identification<a class="headerlink" href="#command-polling-pattern-identification" title="Permanent link">&para;</a></h3>
<p>Monitor the timing and structure of repeated requests to understand the C2 polling mechanism:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>[00:00] POST /gate.php  {&quot;action&quot;: &quot;register&quot;, &quot;bot_id&quot;: &quot;abc123&quot;, ...}
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>[00:01] POST /gate.php  {&quot;action&quot;: &quot;poll&quot;, &quot;bot_id&quot;: &quot;abc123&quot;}
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>[01:01] POST /gate.php  {&quot;action&quot;: &quot;poll&quot;, &quot;bot_id&quot;: &quot;abc123&quot;}
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>[02:01] POST /gate.php  {&quot;action&quot;: &quot;poll&quot;, &quot;bot_id&quot;: &quot;abc123&quot;}
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>[02:02] POST /gate.php  {&quot;action&quot;: &quot;result&quot;, &quot;bot_id&quot;: &quot;abc123&quot;, &quot;sms&quot;: [...]}
</code></pre></div>
<p>From this pattern: registration happens once, polling occurs every 60 seconds, and exfiltration requests are sent immediately when new data is available.</p>
<h3 id="inject-kit-url-extraction">Inject Kit URL Extraction<a class="headerlink" href="#inject-kit-url-extraction" title="Permanent link">&para;</a></h3>
<p>Banking trojans download HTML/JS overlay pages (inject kits) from the C2 to display over legitimate banking apps. These URLs are high-value IOCs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>GET /injects/list?bot_id=abc123&amp;apps=com.bank.app1,com.bank.app2
</code></pre></div>
<p>Response:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="p">{</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="w">    </span><span class="nt">&quot;injects&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">            </span><span class="nt">&quot;app&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.bank.app1&quot;</span><span class="p">,</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">            </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://cdn.evil.com/injects/com.bank.app1.html&quot;</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="w">            </span><span class="nt">&quot;app&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.bank.app2&quot;</span><span class="p">,</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="w">            </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://cdn.evil.com/injects/com.bank.app2.html&quot;</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">    </span><span class="p">]</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="p">}</span>
</code></pre></div>
<p>Download and archive these inject pages -- they contain the phishing forms and reveal which financial institutions the campaign targets.</p>
<h3 id="automated-ioc-extraction-with-mitmproxy">Automated IOC Extraction with mitmproxy<a class="headerlink" href="#automated-ioc-extraction-with-mitmproxy" title="Permanent link">&para;</a></h3>
<p>Use a mitmproxy script to automatically extract and log IOCs from intercepted traffic:</p>
<details class="example">
<summary>mitmproxy IOC Extraction Script</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mitmproxy</span><span class="w"> </span><span class="kn">import</span> <span class="n">http</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="n">iocs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>    <span class="s2">&quot;domains&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>    <span class="s2">&quot;ips&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>    <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>    <span class="s2">&quot;bot_ids&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>    <span class="s2">&quot;telegram_tokens&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="p">}</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="n">telegram_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;bot(\d+:[A-Za-z0-9_-]+)&quot;</span><span class="p">)</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="n">ip_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b&quot;</span><span class="p">)</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">response</span><span class="p">(</span><span class="n">flow</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">HTTPFlow</span><span class="p">):</span>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a>    <span class="n">iocs</span><span class="p">[</span><span class="s2">&quot;domains&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a>    <span class="n">iocs</span><span class="p">[</span><span class="s2">&quot;paths&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a>    <span class="n">ip_match</span> <span class="o">=</span> <span class="n">ip_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a>    <span class="k">if</span> <span class="n">ip_match</span><span class="p">:</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a>        <span class="n">iocs</span><span class="p">[</span><span class="s2">&quot;ips&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a>
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a>    <span class="n">tg_match</span> <span class="o">=</span> <span class="n">telegram_re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a>    <span class="k">if</span> <span class="n">tg_match</span><span class="p">:</span>
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a>        <span class="n">iocs</span><span class="p">[</span><span class="s2">&quot;telegram_tokens&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tg_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a>
<a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a>    <span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">response</span> <span class="ow">and</span> <span class="n">flow</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
<a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a>            <span class="n">body</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bot_id&quot;</span><span class="p">,</span> <span class="s2">&quot;botId&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;uid&quot;</span><span class="p">]:</span>
<a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a>                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">body</span><span class="p">:</span>
<a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a>                        <span class="n">iocs</span><span class="p">[</span><span class="s2">&quot;bot_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">body</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
<a id="__codelineno-42-35" name="__codelineno-42-35" href="#__codelineno-42-35"></a>        <span class="k">except</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">):</span>
<a id="__codelineno-42-36" name="__codelineno-42-36" href="#__codelineno-42-36"></a>            <span class="k">pass</span>
<a id="__codelineno-42-37" name="__codelineno-42-37" href="#__codelineno-42-37"></a>
<a id="__codelineno-42-38" name="__codelineno-42-38" href="#__codelineno-42-38"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/iocs.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-42-39" name="__codelineno-42-39" href="#__codelineno-42-39"></a>        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
<a id="__codelineno-42-40" name="__codelineno-42-40" href="#__codelineno-42-40"></a>            <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iocs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
<a id="__codelineno-42-41" name="__codelineno-42-41" href="#__codelineno-42-41"></a>            <span class="n">f</span><span class="p">,</span>
<a id="__codelineno-42-42" name="__codelineno-42-42" href="#__codelineno-42-42"></a>            <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-42-43" name="__codelineno-42-43" href="#__codelineno-42-43"></a>        <span class="p">)</span>
</code></pre></div>
</details>
<p>Run with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>mitmproxy<span class="w"> </span>--mode<span class="w"> </span>transparent<span class="w"> </span>--listen-port<span class="w"> </span><span class="m">8080</span><span class="w"> </span>-s<span class="w"> </span>ioc_extract.py
</code></pre></div>
<h3 id="ioc-extraction-from-raw-packet-captures">IOC Extraction from Raw Packet Captures<a class="headerlink" href="#ioc-extraction-from-raw-packet-captures" title="Permanent link">&para;</a></h3>
<p>For non-HTTP protocols or when proxy interception is not possible, extract IOCs directly from pcap files using tshark:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>dns.qry.name<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>ip.dst<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;mqtt&quot;</span><span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>mqtt.topic<span class="w"> </span>-e<span class="w"> </span>mqtt.msg
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;tcp.port == 443&quot;</span><span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>tls.handshake.extensions_server_name<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u
</code></pre></div>
<p>For custom TCP protocols, export the TCP stream as raw bytes and analyze the binary structure to extract embedded strings, IPs, or domain names:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;tcp.stream eq 0&quot;</span><span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>data.data<span class="w"> </span><span class="p">|</span><span class="w"> </span>xxd<span class="w"> </span>-r<span class="w"> </span>-p<span class="w"> </span>&gt;<span class="w"> </span>stream0.bin
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>strings<span class="w"> </span>stream0.bin
</code></pre></div>
<h3 id="ioc-pivot-points">IOC Pivot Points<a class="headerlink" href="#ioc-pivot-points" title="Permanent link">&para;</a></h3>
<p>Extracted IOCs can be pivoted to discover related infrastructure, additional samples, and operator identity:</p>
<table>
<thead>
<tr>
<th>IOC Type</th>
<th>Pivot Method</th>
<th>What It Reveals</th>
</tr>
</thead>
<tbody>
<tr>
<td>C2 domain</td>
<td>Passive DNS (VirusTotal, SecurityTrails, Farsight DNSDB)</td>
<td>IP address history, co-hosted domains, registration timeline</td>
</tr>
<tr>
<td>C2 IP address</td>
<td>Shodan/Censys scan, reverse DNS, certificate search</td>
<td>Open admin panels, other services on same IP, hosting provider</td>
</tr>
<tr>
<td>Telegram bot token</td>
<td>Query <code>https://api.telegram.org/bot&lt;token&gt;/getMe</code></td>
<td>Bot name, username, and whether the token is still active</td>
</tr>
<tr>
<td>Firebase project ID</td>
<td>Cross-reference with other samples using the same project</td>
<td>Campaign scope, shared infrastructure across families</td>
</tr>
<tr>
<td>SSL certificate hash</td>
<td>Certificate transparency logs (crt.sh)</td>
<td>All domains using the same certificate, issuance timeline</td>
</tr>
<tr>
<td>Overlay injection URLs</td>
<td>WHOIS, hosting provider, URL scan on VirusTotal</td>
<td>Shared injection hosting infrastructure across campaigns</td>
</tr>
<tr>
<td>Campaign tag</td>
<td>Search tag across your sample corpus and threat intel feeds</td>
<td>Distribution campaigns, dropper apps, target geography</td>
</tr>
<tr>
<td>Bot ID format</td>
<td>Compare generation logic across samples</td>
<td>Family lineage, code reuse between campaigns</td>
</tr>
<tr>
<td>User-Agent string</td>
<td>Search in proxy logs and threat intel databases</td>
<td>Other samples using the same hardcoded UA string</td>
</tr>
<tr>
<td>Encryption key</td>
<td>Compare static keys across samples</td>
<td>Shared builder, same operator, campaign correlation</td>
</tr>
</tbody>
</table>
<p>For detailed C2 protocol structures and command mappings, see <a href="../../attacks/c2-techniques/">C2 Communication Techniques</a>.</p>
<h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://portswigger.net/burp">Burp Suite</a></td>
<td>HTTP/HTTPS interception and modification</td>
</tr>
<tr>
<td><a href="https://mitmproxy.org/">mitmproxy</a></td>
<td>Scriptable HTTPS proxy with Python addon API for automated C2 analysis</td>
</tr>
<tr>
<td><a href="https://github.com/emanuele-f/PCAPdroid">PCAPdroid</a></td>
<td>No-root Android traffic capture via local VPN</td>
</tr>
<tr>
<td><a href="https://www.wireshark.org/">Wireshark</a></td>
<td>Packet-level protocol analysis (MQTT, WebSocket, custom TCP)</td>
</tr>
<tr>
<td><a href="https://www.wireshark.org/docs/man-pages/tshark.html">tshark</a></td>
<td>Command-line Wireshark for scripted pcap analysis and IOC extraction</td>
</tr>
<tr>
<td><a href="https://www.tcpdump.org/">tcpdump</a></td>
<td>Command-line packet capture on device</td>
</tr>
<tr>
<td><a href="https://frida.re/">Frida</a></td>
<td>Runtime instrumentation for network hooks, SSL bypass, crypto capture</td>
</tr>
<tr>
<td><a href="https://github.com/sensepost/objection">Objection</a></td>
<td>One-command SSL pinning bypass and runtime exploration</td>
</tr>
<tr>
<td><a href="https://github.com/zahidaz/refrida">reFrida</a></td>
<td>Browser-based Frida IDE with network activity monitoring</td>
</tr>
<tr>
<td><a href="https://github.com/Impact-I/reFlutter">reFlutter</a></td>
<td>Flutter <code>libflutter.so</code> patching for BoringSSL bypass</td>
</tr>
<tr>
<td><a href="https://github.com/NVISOsecurity/MagiskTrustUserCerts">MagiskTrustUserCerts</a></td>
<td>Magisk module to move user CA certs to system store</td>
</tr>
<tr>
<td><a href="https://apktool.org/">apktool</a></td>
<td>APK decompilation for <code>network_security_config.xml</code> patching</td>
</tr>
<tr>
<td><a href="https://gchq.github.io/CyberChef/">CyberChef</a></td>
<td>Browser-based decoder for AES, Base64, XOR on captured payloads</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>